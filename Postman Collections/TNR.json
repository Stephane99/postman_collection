{
  "info": {
    "_postman_id": "8ed866f9-6df4-48dd-af77-365166779384",
    "name": "End2End - old",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "_postman_id": "338cc0f3-3c52-401d-867e-93b19ee2bd38",
      "name": "Customers",
      "description": "",
      "item": [
        {
          "_postman_id": "bb9847fb-7b15-439c-9274-8fdc1d1f6ab8",
          "name": "Create customer",
          "description": "",
          "item": [
            {
              "_postman_id": "4e45db3b-1036-4e8c-848f-b0cf913c9ff3",
              "name": "Create a new customer",
              "description": "",
              "item": [
                {
                  "_postman_id": "bfe5a79e-5f65-41e9-8107-ab3a99b34287",
                  "name": "Post new Customer",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const uniqueId = utils.getUniqueIdBasedOnDate();",
                          "pm.variables.set('uniqueId', uniqueId)",
                          "pm.environment.set('external_id', uniqueId);"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"fcabrel@oui.sncf{{uniqueId}}\",\n\t\"firstName\": \"Francis{{uniqueId}}\",\n\t\"lastName\": \"CABREL{{uniqueId}}\",\n\t\"phoneNumber\": \"0687654321{{uniqueId}}\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers",
                    "description": "Couvert par end2end js"
                  },
                  "response": []
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "04b7b4d1-41c5-4a6e-9a3b-e0aed5c82a14",
              "name": "Create a customer who already exists",
              "description": "Faire un POST pour cr\u00e9er un CUSTOMER\r\n--> tester l'unicit\u00e9 de l'external_REF pour un CHANNEL donn\u00e9\r\n\r\nStory: MAAS-308",
              "item": [
                {
                  "_postman_id": "bce16d70-fd47-4d2f-b81c-216dfb73e0a9",
                  "name": "Post new Customer",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "console.log('2')",
                          "const utils = eval(globals.loadUtils);",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const externalId = utils.getUniqueIdBasedOnDate();",
                          "pm.environment.set('external_id', externalId);"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "ef7c7261-e511-4fc1-acf0-f2f3cd845d1b",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"adelon@oui.sncf\",\n\t\"firstName\": \"Alain\",\n\t\"lastName\": \"DELON\",\n\t\"phoneNumber\": \"+33612345678\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers",
                    "description": "Couvert par end2end js"
                  },
                  "response": []
                },
                {
                  "_postman_id": "eac51782-58c2-4700-b9fb-a46e6ca13148",
                  "name": "Post customer with same ExternalID - already exists",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "const uniqueId = utils.getUniqueIdBasedOnDate(); // unique id on 12 digits",
                          "",
                          "pm.variables.set('uniqueId', uniqueId)",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "pm.test(\"Check error message = 'USER_ALREADY_EXISTS'\", function(){",
                          "    pm.expect(pm.response.code).to.equal(409);",
                          "     console.log(json)",
                          "    pm.expect(json.error).to.equal('USER_ALREADY_EXISTS');",
                          "});"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"fcabrel@oui.sncf{{uniqueId}}\",\n\t\"firstName\": \"Francis{{uniqueId}}\",\n\t\"lastName\": \"CABREL{{uniqueId}}\",\n\t\"phoneNumber\": \"0687654321{{uniqueId}}\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers",
                    "description": "Couvert par end2end js"
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "8434315b-efe1-4877-8982-0c0be7aa3720",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "e817f2b1-f957-4204-94f4-4893f6cea539",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "8a4397c8-1c20-4d11-83c6-298325dc97bf",
              "name": "Create customer without authorization",
              "description": "Faire un POST pour cr\u00e9er un CUSTOMER\r\n--> tester le oAuth\r\n\r\nStory: MAAS-308",
              "item": [
                {
                  "_postman_id": "3428a2bd-74dd-400f-ae01-c099387fb49e",
                  "name": "Post new Customer without authorization - unauthorized",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const uniqueId = utils.getUniqueIdBasedOnDate(); // unique id on 12 digits",
                          "pm.environment.set('external_id', uniqueId);",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndType(401, \"UNAUTHORIZED\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "auth": {
                      "type": "noauth"
                    },
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"gdepardieu@oui.sncf\",\n\t\"firstName\": \"G\u00e9rard\",\n\t\"lastName\": \"DEPARDIEU\",\n\t\"phoneNumber\": \"0611223344\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers",
                    "description": "Couvert par end2end js"
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "644f80d1-d6d7-41ec-8c43-dab16b4b8a54",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "9cf84048-30be-421f-8ad1-0f68992e7ef1",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "14a4f5b1-d6e5-4829-bc48-137eac4661c5",
              "name": "Check mandatory fields of customer creation",
              "description": "Faire un POST pour cr\u00e9er un CUSTOMER\r\n--> tester les champs obligatoires\r\n\r\nStory: MAAS-308",
              "item": [
                {
                  "_postman_id": "ee038d97-f50c-42ec-b490-51f59dd2c024",
                  "name": "Post new Customer with a mandatory field empty",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "e5c40c55-4c3b-4482-8df0-625d3592c15e",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(400, \"INVALID_REQUEST\");",
                          "utils.checkResponseError(\"\\\"firstName\\\" is not allowed to be empty\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"adelon@oui.sncf\",\n\t\"firstName\": \"\",\n\t\"lastName\": \"DELON\",\n\t\"phoneNumber\": \"0612345678\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers"
                  },
                  "response": []
                },
                {
                  "_postman_id": "21d5663e-d77f-47f9-b9f2-8c29e74dde4b",
                  "name": "Post new Customer with all mandatory fields empty",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "e5c40c55-4c3b-4482-8df0-625d3592c15e",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "// TODO : Test d\u00e9sactiv\u00e9, \u00e0 remettre lorsque l'ano sera corrig\u00e9e",
                          "//utils.checkResponseCodeAndStatus(400, \"INVALID_REQUEST\");",
                          "//pm.test.skip(\"=> BUG JIRA MAAS-327\");",
                          "",
                          "// TODO : Test d\u00e9sactiv\u00e9, \u00e0 remettre lorsque l'ano sera corrig\u00e9e",
                          "//utils.checkResponseError(\"\\\"email\\\" is not allowed to be empty, \\\"firstName\\\" is not allowed to be empty, \\\"lastName\\\" is not allowed to be empty, \\\"externalId\\\" is not allowed to be empty, \\\"phoneNumber\\\" is not allowed to be empty\");",
                          "//pm.test.skip(\"=> BUG JIRA MAAS-327\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"\",\n\t\"firstName\": \"\",\n\t\"lastName\": \"\",\n\t\"phoneNumber\": \"\",\n\t\"externalId\": \"\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers",
                    "description": "Ano en cours : MAAS-327"
                  },
                  "response": []
                },
                {
                  "_postman_id": "f22f0253-3531-4679-95ed-ee7c63e3b34b",
                  "name": "Post new Customer with a mandatory field not defined",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "e5c40c55-4c3b-4482-8df0-625d3592c15e",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "// TODO : Test d\u00e9sactiv\u00e9, \u00e0 remettre lorsque l'ano sera corrig\u00e9e",
                          "//utils.checkResponseCodeAndStatus(400, \"INVALID_REQUEST\");",
                          "//pm.test.skip(\"=> BUG JIRA MAAS-327\");",
                          "",
                          "// TODO : Test d\u00e9sactiv\u00e9, \u00e0 remettre lorsque l'ano sera corrig\u00e9e",
                          "//utils.checkResponseError(\"\\\"firstName\\\" is not allowed to be not defined\");",
                          "//pm.test.skip(\"=> BUG JIRA MAAS-327\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"adelon@oui.sncf\",\n\t\"lastName\": \"DELON\",\n\t\"phoneNumber\": \"0612345678\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers",
                    "description": "Ano en cours : MAAS-327"
                  },
                  "response": []
                },
                {
                  "_postman_id": "e611620b-3e12-498f-a262-a4d972e83912",
                  "name": "Post new Customer with all mandatory fields not defined",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "e5c40c55-4c3b-4482-8df0-625d3592c15e",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "",
                          "// TODO : Test d\u00e9sactiv\u00e9, \u00e0 remettre lorsque l'ano sera corrig\u00e9e",
                          "//utils.checkResponseCodeAndStatus(400, \"INVALID_REQUEST\");",
                          "//pm.test.skip(\"=> BUG JIRA MAAS-327\");",
                          "",
                          "// TODO : Test d\u00e9sactiv\u00e9, \u00e0 remettre lorsque l'ano sera corrig\u00e9e",
                          "//utils.checkResponseError(\"\\\"email\\\" is not allowed to be not defined, \\\"firstName\\\" is not allowed to be not defined, \\\"lastName\\\" is not allowed to be not defined, \\\"externalId\\\" is not allowed to be not defined, \\\"phoneNumber\\\" is not allowed to be not defined\");",
                          "//pm.test.skip(\"=> BUG JIRA MAAS-327\");"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers",
                    "description": "Ano en cours : MAAS-327"
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "198da16e-a190-4cf7-8db5-76c58d53f842",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "fdb912be-0117-4afa-bf2c-bc4dbec26c0c",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "5c10221e-57dc-4794-99ba-69c7aaefe3cf",
              "name": "Create customer with invalid email",
              "description": "",
              "item": [
                {
                  "_postman_id": "252a89c0-a194-4777-a450-9de5a5973a9e",
                  "name": "Post new Customer with invalid email - error",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const uniqueId = utils.getUniqueIdBasedOnDate();",
                          "pm.environment.set('external_id', uniqueId);",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "// TODO : Test d\u00e9sactiv\u00e9, \u00e0 remettre lorsque l'ano sera corrig\u00e9e",
                          "//utils.checkResponseCodeAndStatus(400, \"INVALID_REQUEST\");",
                          "//pm.test.skip(\"=> BUG JIRA MAAS-327\");",
                          "",
                          "// TODO : Test d\u00e9sactiv\u00e9, \u00e0 remettre lorsque l'ano sera corrig\u00e9e",
                          "//utils.checkResponseError(\"\\\"email\\\" must be a valid email\");",
                          "//pm.test.skip(\"=> BUG JIRA MAAS-327\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"gdepardieu_oui.sncf\",\n\t\"firstName\": \"G\u00e9rard\",\n\t\"lastName\": \"DEPARDIEU\",\n\t\"phoneNumber\": \"0611223344\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers"
                  },
                  "response": []
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "ee5aedf2-41fd-4f60-86e1-0c6f29dd3faa",
              "name": "Create Customer with different channels",
              "description": "Faire un POST pour cr\u00e9er un CUSTOMER\r\n--> tester que deux channel peuvent cr\u00e9er un customer avec le m\u00eame External_REF\r\n\r\nStory : MAAS-308",
              "item": [
                {
                  "_postman_id": "02c58610-1ee1-44e5-a9cb-9db256ac311a",
                  "name": "Post new Customer",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "5abff45b-fa92-4c5c-910c-a5e7d26e3e5e",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const externalId = utils.getUniqueIdBasedOnDate();",
                          "",
                          "pm.environment.set('external_id', externalId);",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "f3c90239-08a0-4fea-817b-e3d50cce1564",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"mfarmer@oui.sncf\",\n\t\"firstName\": \"Myl\u00e8ne\",\n\t\"lastName\": \"FARMER\",\n\t\"phoneNumber\": \"+33688776655\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers",
                    "description": "Couvert par end2end js"
                  },
                  "response": []
                },
                {
                  "_postman_id": "5a3fc1c4-d853-4a1e-9fd0-1ecd6bd9df31",
                  "name": "Post customer with same ExternalID via a different channel",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_oss44\"), pm.environment.get(\"secret_oss44\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"mfarmer@oui.sncf\",\n\t\"firstName\": \"Myl\u00e8ne\",\n\t\"lastName\": \"FARMER\",\n\t\"phoneNumber\": \"+33688776655\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers"
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "fee345fa-81f2-42ef-849d-cce556498baa",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "43a08455-f43c-4e1c-821a-5719850985a4",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            }
          ],
          "_postman_isSubFolder": true
        },
        {
          "_postman_id": "2705ec06-5b7f-495b-88ee-5d16aafe8aa5",
          "name": "Get customer",
          "description": "",
          "item": [
            {
              "_postman_id": "8a61336b-16dd-43fb-86cd-231c3d73e23d",
              "name": "Get user created in channel 1",
              "description": "Faire un GET du CUSTOMER\r\n--> v\u00e9rifier que c'est le bon client qui remonte \r\n--> v\u00e9rifier que ce customer ne remonte pas pour un autre CHANNEL\r\n=> Lorsque l'externalid est d\u00e9fini dans un seul 2 channel\r\n\r\nStory : MAAS-308",
              "item": [
                {
                  "_postman_id": "f7144c6c-d206-4dbc-9f78-655b7f30910a",
                  "name": "Post new Customer in channel 1",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const uniqueId = utils.getUniqueIdBasedOnDate();",
                          "pm.environment.set('external_id', uniqueId);"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"leaseydoux@oui.sncf\",\n\t\"firstName\": \"Lea\",\n\t\"lastName\": \"SEYDOUX\",\n\t\"phoneNumber\": \"0601010101\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers",
                    "description": "Couvert par end2end js"
                  },
                  "response": []
                },
                {
                  "_postman_id": "2fd9940b-3648-4848-997b-91035b487ef2",
                  "name": "Get Customer from channel 1 - success",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "id": "445376b0-c898-41f4-9b5e-10214aae0f25",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "const getCustomerUtils = eval(globals.getCustomerUtils);",
                          "",
                          "getCustomerUtils.assertGetCustomer();",
                          "",
                          "pm.test('customer phoneNumber', function() {",
                          "    pm.expect(json.phoneNumber).to.equal(\"0601010101\");",
                          "});",
                          "",
                          "pm.test('customer externalId', function() {",
                          "    pm.expect(json.externalId).to.equal(pm.environment.get(\"external_id\"));",
                          "});",
                          "",
                          "pm.test('customer email', function() {",
                          "    pm.expect(json.email).to.equal(\"leaseydoux@oui.sncf\");",
                          "});",
                          "",
                          "pm.test('customer firstName', function() {",
                          "    pm.expect(json.firstName).to.equal(\"Lea\");",
                          "});",
                          "",
                          "pm.test('customer lastName', function() {",
                          "    pm.expect(json.lastName).to.equal(\"SEYDOUX\");",
                          "});",
                          "",
                          "// TODO : A \u00e9tudier",
                          "//pm.test.skip('JIRA 327 - Champ Origin retourn\u00e9, mais non pr\u00e9sent dans le swagger ', function() {});"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "e1d87fef-2acf-49a3-b1ac-f90cdc75f49b",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id}}"
                        }
                      ]
                    }
                  },
                  "response": []
                },
                {
                  "_postman_id": "d29b052e-286e-4d18-a508-4d0aacdc3869",
                  "name": "Get Customer from channel 2 - user not found",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "id": "445376b0-c898-41f4-9b5e-10214aae0f25",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCode(404);",
                          "utils.checkResponseError(\"USER_NOT_FOUND\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "39f9a651-4774-4018-8e19-8340b4fde458",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_oss44\"), pm.environment.get(\"secret_oss44\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id}}"
                        }
                      ]
                    }
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "b45c5703-623d-4b70-9c1d-d942ee2c22e8",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "fc9ca302-b3e7-424d-a50d-40d0c2a5c92d",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "eba751b3-0fce-4c51-968b-e6a08c358dab",
              "name": "Get then create a customer, checking that there is no cache",
              "description": "Faire un GET du CUSTOMER avant sa cr\u00e9ation\r\n--> v\u00e9rifier que l'utilisateur n'est bien pas trouv\u00e9\r\n--> cr\u00e9er le customer\r\n--> v\u00e9rifier que l'utilisateur est bien trouv\u00e9\r\n",
              "item": [
                {
                  "_postman_id": "3d976d58-9a47-499b-a76b-5728c6b7b866",
                  "name": "Get Customer from channel 1 - user not found",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "id": "445376b0-c898-41f4-9b5e-10214aae0f25",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCode(404);",
                          "utils.checkResponseError(\"USER_NOT_FOUND\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "e1d87fef-2acf-49a3-b1ac-f90cdc75f49b",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const uniqueId = utils.getUniqueIdBasedOnDate();",
                          "pm.environment.set('external_id', uniqueId);"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id}}"
                        }
                      ]
                    },
                    "description": "Couvert par end2end js"
                  },
                  "response": []
                },
                {
                  "_postman_id": "bd086e9d-14da-4993-a3c6-3aa2e372784a",
                  "name": "Post new Customer in channel 1",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"leaseydoux@oui.sncf\",\n\t\"firstName\": \"Lea\",\n\t\"lastName\": \"SEYDOUX\",\n\t\"phoneNumber\": \"0601010101\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers"
                  },
                  "response": []
                },
                {
                  "_postman_id": "6c012d63-1ada-4ae8-9d8b-b6d67f9ef6b7",
                  "name": "Get Customer from channel 1 - success",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "id": "445376b0-c898-41f4-9b5e-10214aae0f25",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "const getCustomerUtils = eval(globals.getCustomerUtils);",
                          "",
                          "getCustomerUtils.assertGetCustomer();",
                          "",
                          "// Corrig\u00e9 ? A voir avec Jean-Charles",
                          "//pm.test.skip('JIRA 344 - [Customers] Mauvaise gestion du cache sur le GET d\\'un customer', function() {});",
                          "",
                          "pm.test('customer phoneNumber', function() {",
                          "    pm.expect(json.phoneNumber).to.equal(\"0601010101\");",
                          "});",
                          "",
                          "pm.test('customer externalId', function() {",
                          "    pm.expect(json.externalId).to.equal(pm.environment.get(\"external_id\"));",
                          "});",
                          "",
                          "pm.test('customer email', function() {",
                          "    pm.expect(json.email).to.equal(\"leaseydoux@oui.sncf\");",
                          "});",
                          "",
                          "pm.test('customer firstName', function() {",
                          "    pm.expect(json.firstName).to.equal(\"Lea\");",
                          "});",
                          "",
                          "pm.test('customer lastName', function() {",
                          "    pm.expect(json.lastName).to.equal(\"SEYDOUX\");",
                          "});",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "e1d87fef-2acf-49a3-b1ac-f90cdc75f49b",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id}}"
                        }
                      ]
                    }
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "b45c5703-623d-4b70-9c1d-d942ee2c22e8",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "fc9ca302-b3e7-424d-a50d-40d0c2a5c92d",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "74d1d128-a1df-4b44-a7c0-fd325ace3f7e",
              "name": "Get user with externalid existing in two channels",
              "description": "Faire un GET du CUSTOMER\r\n--> v\u00e9rifier que c'est le bon client qui remonte \r\n--> v\u00e9rifier que ce customer ne remonte pas pour un autre CHANNEL\r\n=> Lorsque l'externalid est d\u00e9fini dans les 2 channels\r\n\r\nStory : MAAS-308",
              "item": [
                {
                  "_postman_id": "097d757b-f8ab-44a7-8e70-454382055508",
                  "name": "Post new Customer in channel 1",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const uniqueId = utils.getUniqueIdBasedOnDate();",
                          "pm.globals.set(\"external_id_1\", uniqueId);"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"mlaroque@oui.sncf\",\n\t\"firstName\": \"Michelle\",\n\t\"lastName\": \"Laroque\",\n\t\"phoneNumber\": \"0602020202\",\n\t\"externalId\": \"{{external_id_1}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers",
                    "description": "Couvert par end2end js"
                  },
                  "response": []
                },
                {
                  "_postman_id": "8c11318e-7ec0-4282-94c5-53c91f60df61",
                  "name": "Post new Customer in channel 2 with same external_id",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_oss44\"), pm.environment.get(\"secret_oss44\"));",
                          "",
                          "pm.globals.set(\"external_id_2\", globals.external_id_1);"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"mcotillard@oui.sncf\",\n\t\"firstName\": \"Marion\",\n\t\"lastName\": \"Cotillard\",\n\t\"phoneNumber\": \"0603030303\",\n\t\"externalId\": \"{{external_id_2}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers"
                  },
                  "response": []
                },
                {
                  "_postman_id": "a6b1e3da-bc95-4440-bd71-d09eaccd6d70",
                  "name": "Get Customer from channel 1 - success",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "id": "445376b0-c898-41f4-9b5e-10214aae0f25",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "/*",
                          "const getCustomerUtils = eval(globals.getCustomerUtils);",
                          "",
                          "getCustomerUtils.assertGetCustomer();",
                          "*/",
                          "",
                          "pm.test('customer phoneNumber of channel 1', function() {",
                          "    pm.expect(json.phoneNumber).to.equal(\"0602020202\");",
                          "});",
                          "",
                          "pm.test('customer externalId of channel 1', function() {",
                          "    pm.expect(json.externalId).to.equal(globals.external_id_1);",
                          "});",
                          "",
                          "pm.test('customer email of channel 1', function() {",
                          "    pm.expect(json.email).to.equal(\"mlaroque@oui.sncf\");",
                          "});",
                          "",
                          "pm.test('customer firstName of channel 1', function() {",
                          "    pm.expect(json.firstName).to.equal(\"Michelle\");",
                          "});",
                          "",
                          "pm.test('customer lastName of channel 1', function() {",
                          "    pm.expect(json.lastName).to.equal(\"Laroque\");",
                          "});",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "e1d87fef-2acf-49a3-b1ac-f90cdc75f49b",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_1}}"
                        }
                      ]
                    }
                  },
                  "response": []
                },
                {
                  "_postman_id": "e5287e6c-2f0f-43ab-8ba3-9ee1dbce5543",
                  "name": "Get Customer from channel 2 - success",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "id": "445376b0-c898-41f4-9b5e-10214aae0f25",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "const getCustomerUtils = eval(globals.getCustomerUtils);",
                          "",
                          "getCustomerUtils.assertGetCustomer();",
                          "",
                          "pm.test('customer externalId of channel 2', function() {",
                          "    pm.expect(json.externalId).to.equal(globals.external_id_1);",
                          "});",
                          "",
                          "pm.test('customer email of channel 2', function() {",
                          "    pm.expect(json.email).to.equal(\"mcotillard@oui.sncf\");",
                          "});",
                          "",
                          "pm.test('customer firstName of channel 2', function() {",
                          "    pm.expect(json.firstName).to.equal(\"Marion\");",
                          "});",
                          "",
                          "pm.test('customer lastName of channel 2', function() {",
                          "    pm.expect(json.lastName).to.equal(\"Cotillard\");",
                          "});",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "e1d87fef-2acf-49a3-b1ac-f90cdc75f49b",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_oss44\"), pm.environment.get(\"secret_oss44\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_2}}"
                        }
                      ]
                    }
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "81392697-b548-45d4-ab52-df8152fc78d0",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "a12f1179-a786-42f9-9ae5-d167aaf6fb41",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "f7f6a9a0-05cd-4bb9-a6b3-540d70016f92",
              "name": "Get customer without authorization",
              "description": "Faire un GET pour r\u00e9cup\u00e9rer un CUSTOMER\r\n--> tester le oAuth\r\n\r\nStory: MAAS-308",
              "item": [
                {
                  "_postman_id": "a15bef33-ae1c-45e2-841f-db987f9eb82e",
                  "name": "Post new Customer",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const uniqueId = utils.getUniqueIdBasedOnDate();",
                          "pm.environment.set('external_id', uniqueId);"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"jbalasko@oui.sncf\",\n\t\"firstName\": \"Josiane\",\n\t\"lastName\": \"Balascko\",\n\t\"phoneNumber\": \"0604040404\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers",
                    "description": "Couvert par end2end js"
                  },
                  "response": []
                },
                {
                  "_postman_id": "9c981f67-617d-4c1c-8e87-9b32d053a6bc",
                  "name": "Get Customer  without authorization - missing token",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "const uniqueId = utils.getUniqueIdBasedOnDate(); // unique id on 12 digits",
                          "pm.environment.set('external_id', uniqueId);",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndType(403, \"MISSING_AUTHENTICATION_TOKEN\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "auth": {
                      "type": "noauth"
                    },
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": ""
                        }
                      ]
                    }
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "644f80d1-d6d7-41ec-8c43-dab16b4b8a54",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "9cf84048-30be-421f-8ad1-0f68992e7ef1",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            }
          ],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "52637acb-c5b0-4f01-a4cc-1a8f6ed6d9be",
                "type": "text/javascript",
                "exec": [
                  "postman.setGlobalVariable(\"getCustomerUtils\", function loadGetCustomerUtils() {",
                  "    return {",
                  "",
                  "        assertGetCustomer: function() {",
                  "",
                  "            const expectedSchema = {",
                  "                type: 'object',",
                  "                required: ['phoneNumber', 'origin', 'externalId', 'email', 'firstName', 'lastName']",
                  "            };",
                  "            ",
                  "            utils.checkResponseCode(200);",
                  "            ",
                  "            // TODO : Test d\u00e9sactiv\u00e9, ne fonctionne que sur le poste de St\u00e9phane D. Pourquoi ?",
                  "            //utils.checkJsonSchema(expectedSchema);",
                  "",
                  "        }",
                  "    };",
                  "} + '; loadGetCustomerUtils();');"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "265842b0-9402-4f9e-ac60-a7391c407c25",
                "type": "text/javascript",
                "exec": [
                  ""
                ]
              }
            }
          ],
          "_postman_isSubFolder": true
        },
        {
          "_postman_id": "73721738-6bb2-4cf1-a2d1-94a2b51131c5",
          "name": "Update customer",
          "description": "",
          "item": [
            {
              "_postman_id": "5d6a0fd8-7abd-4552-98f4-6c62023beff6",
              "name": "Update customer on channel 1, not accessible with channel 2",
              "description": "Faire un PUT du CUSTOMER\r\n--> v\u00e9rifier que c'est le bon client qui est mis \u00e0 jour\r\n--> v\u00e9rifier qu'un autre canal ne peut pas mettre \u00e0 jour ce client\r\n--> v\u00e9rifier que la mise \u00e0 jour est bien prise en compte avec un GET\r\n=> Lorsque le external_id n'est d\u00e9fini que par un seul channel",
              "item": [
                {
                  "_postman_id": "6722a8ae-c5db-4af5-b0a0-35bc9a21ff19",
                  "name": "Post new Customer by channel 1",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const uniqueId = utils.getUniqueIdBasedOnDate();",
                          "pm.globals.set(\"external_id_1\", uniqueId);"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"ihupert@oui.sncf\",\n\t\"firstName\": \"Isabelle\",\n\t\"lastName\": \"Hupert\",\n\t\"phoneNumber\": \"0606060606\",\n\t\"externalId\": \"{{external_id_1}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers",
                    "description": "Couvert par end2end js"
                  },
                  "response": []
                },
                {
                  "_postman_id": "39d1e07b-ac17-4782-9405-f91d9b283f4b",
                  "name": "Get Customer by channel 1",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "id": "445376b0-c898-41f4-9b5e-10214aae0f25",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCode(200);",
                          "",
                          "pm.test('customer phoneNumber of channel 1', function() {",
                          "    pm.expect(json.phoneNumber).to.equal(\"0606060606\");",
                          "});",
                          "",
                          "pm.test('customer externalId of channel 1', function() {",
                          "    pm.expect(json.externalId).to.equal(globals.external_id_1);",
                          "});",
                          "",
                          "pm.test('customer email of channel 1', function() {",
                          "    pm.expect(json.email).to.equal(\"ihupert@oui.sncf\");",
                          "});",
                          "",
                          "pm.test('customer firstName of channel 1', function() {",
                          "    pm.expect(json.firstName).to.equal(\"Isabelle\");",
                          "});",
                          "",
                          "pm.test('customer lastName of channel 1', function() {",
                          "    pm.expect(json.lastName).to.equal(\"Hupert\");",
                          "});",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "e1d87fef-2acf-49a3-b1ac-f90cdc75f49b",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_1}}"
                        }
                      ]
                    }
                  },
                  "response": []
                },
                {
                  "_postman_id": "8055e4b3-9898-498d-91fe-5b0ac0422559",
                  "name": "Update Customer by channel 1",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "95be62be-f983-46eb-bf7a-e07469382a20",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "5f7263d8-e106-4f9a-9163-5dc1be24bd23",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(200, \"SUCCESS\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "PUT",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"firstName\": \"Sophie\",\n\t\"lastName\": \"Marceau\",\n\t\"email\": \"smarceau@oui.sncf\",\n\t\"phoneNumber\": \"0607070707\"\n}"
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_1}}"
                        }
                      ]
                    }
                  },
                  "response": []
                },
                {
                  "_postman_id": "b7f3638a-3514-415c-90d6-1d686d998152",
                  "name": "Get updated Customer by channel 1",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "id": "445376b0-c898-41f4-9b5e-10214aae0f25",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCode(200);",
                          "",
                          "pm.test('customer phoneNumber of channel 1', function() {",
                          "    pm.expect(json.phoneNumber).to.equal(\"0607070707\");",
                          "});",
                          "",
                          "pm.test('customer externalId of channel 1', function() {",
                          "    pm.expect(json.externalId).to.equal(globals.external_id_1);",
                          "});",
                          "",
                          "pm.test('customer email of channel 1', function() {",
                          "    pm.expect(json.email).to.equal(\"smarceau@oui.sncf\");",
                          "});",
                          "",
                          "pm.test('customer firstName of channel 1', function() {",
                          "    pm.expect(json.firstName).to.equal(\"Sophie\");",
                          "});",
                          "",
                          "pm.test('customer lastName of channel 1', function() {",
                          "    pm.expect(json.lastName).to.equal(\"Marceau\");",
                          "});",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "e1d87fef-2acf-49a3-b1ac-f90cdc75f49b",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_1}}"
                        }
                      ]
                    }
                  },
                  "response": []
                },
                {
                  "_postman_id": "108649cb-c8be-480b-9e79-a93a3b2b99b5",
                  "name": "Update Customer by channel 2 - user not found",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "95be62be-f983-46eb-bf7a-e07469382a20",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_oss44\"), pm.environment.get(\"secret_oss44\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "5f7263d8-e106-4f9a-9163-5dc1be24bd23",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "pm.test(\"Check error message = 'USER_NOT_FOUND'\", function(){",
                          "    pm.expect(pm.response.code).to.equal(404);",
                          "    pm.expect(json.error).to.equal('USER_NOT_FOUND');",
                          "});"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "PUT",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"firstName\": \"Sophie2\",\n\t\"lastName\": \"Marceau2\",\n\t\"email\": \"smarceau2@oui.sncf\",\n\t\"phoneNumber\": \"06070707072\"\n}"
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_1}}"
                        }
                      ]
                    }
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "ca5d6801-f2ee-47f5-a768-9aad968d10c8",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "64293408-ff82-4551-a4e3-e73517e93efe",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "1c10bc70-e883-447e-adc2-ff7b3360583f",
              "name": "Update customer with externalid existing in two channels",
              "description": "Faire un PUT du CUSTOMER\r\n--> v\u00e9rifier que c'est le bon client qui est mis \u00e0 jour \r\n--> v\u00e9rifier que ce customer ne remonte pas pour un autre CHANNEL\r\n=> Lorsque l'externalid est d\u00e9fini dans les 2 channels\r\n\r\nStory : MAAS-308",
              "item": [
                {
                  "_postman_id": "2d3860df-1f89-46f5-8040-e6e3a0e36de1",
                  "name": "Post new Customer in channel 1",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const uniqueId = utils.getUniqueIdBasedOnDate();",
                          "pm.globals.set(\"external_id_1\", uniqueId);"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"mlaurent@oui.sncf\",\n\t\"firstName\": \"M\u00e9lanie\",\n\t\"lastName\": \"Laurent\",\n\t\"phoneNumber\": \"0608080808\",\n\t\"externalId\": \"{{external_id_1}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers"
                  },
                  "response": []
                },
                {
                  "_postman_id": "5295ad7c-bf00-498a-9792-3014a5b5f8a0",
                  "name": "Post new Customer in channel 2 with same external_id",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_oss44\"), pm.environment.get(\"secret_oss44\"));",
                          "",
                          "pm.globals.set(\"external_id_2\", globals.external_id_1);"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"atautou@oui.sncf\",\n\t\"firstName\": \"Audrey\",\n\t\"lastName\": \"Tautou\",\n\t\"phoneNumber\": \"0609090909\",\n\t\"externalId\": \"{{external_id_2}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers"
                  },
                  "response": []
                },
                {
                  "_postman_id": "bbfb08f8-b1c1-4002-8c8f-a8ab47a9cd7e",
                  "name": "Get Customer from channel 1",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "id": "445376b0-c898-41f4-9b5e-10214aae0f25",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCode(200);",
                          "",
                          "pm.test('customer phoneNumber of channel 1', function() {",
                          "    pm.expect(json.phoneNumber).to.equal(\"0608080808\");",
                          "});",
                          "",
                          "pm.test('customer externalId of channel 1', function() {",
                          "    pm.expect(json.externalId).to.equal(globals.external_id_1);",
                          "});",
                          "",
                          "pm.test('customer email of channel 1', function() {",
                          "    pm.expect(json.email).to.equal(\"mlaurent@oui.sncf\");",
                          "});",
                          "",
                          "pm.test('customer firstName of channel 1', function() {",
                          "    pm.expect(json.firstName).to.equal(\"M\u00e9lanie\");",
                          "});",
                          "",
                          "pm.test('customer lastName of channel 1', function() {",
                          "    pm.expect(json.lastName).to.equal(\"Laurent\");",
                          "});",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "e1d87fef-2acf-49a3-b1ac-f90cdc75f49b",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_1}}"
                        }
                      ]
                    }
                  },
                  "response": []
                },
                {
                  "_postman_id": "de503032-97c2-43fa-b503-ec54ae9a4175",
                  "name": "Get Customer from channel 2",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "id": "445376b0-c898-41f4-9b5e-10214aae0f25",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCode(200);",
                          "",
                          "pm.test('customer phoneNumber of channel 1', function() {",
                          "    pm.expect(json.phoneNumber).to.equal(\"0609090909\");",
                          "});",
                          "",
                          "pm.test('customer externalId of channel 1', function() {",
                          "    pm.expect(json.externalId).to.equal(globals.external_id_1);",
                          "});",
                          "",
                          "pm.test('customer email of channel 1', function() {",
                          "    pm.expect(json.email).to.equal(\"atautou@oui.sncf\");",
                          "});",
                          "",
                          "pm.test('customer firstName of channel 1', function() {",
                          "    pm.expect(json.firstName).to.equal(\"Audrey\");",
                          "});",
                          "",
                          "pm.test('customer lastName of channel 1', function() {",
                          "    pm.expect(json.lastName).to.equal(\"Tautou\");",
                          "});",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "e1d87fef-2acf-49a3-b1ac-f90cdc75f49b",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_oss44\"), pm.environment.get(\"secret_oss44\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_2}}"
                        }
                      ]
                    }
                  },
                  "response": []
                },
                {
                  "_postman_id": "f1fd9ae1-1bba-4b40-a3c6-36b35fe277fd",
                  "name": "Update Customer by channel 1",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "95be62be-f983-46eb-bf7a-e07469382a20",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "5f7263d8-e106-4f9a-9163-5dc1be24bd23",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(200, \"SUCCESS\");"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "PUT",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"firstName\": \"Catherine\",\n\t\"lastName\": \"Frot\",\n\t\"email\": \"cfrot@oui.sncf\",\n\t\"phoneNumber\": \"0610101010\"\n}"
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_1}}"
                        }
                      ]
                    }
                  },
                  "response": []
                },
                {
                  "_postman_id": "a700f57f-dcac-4a67-a4ed-7fd22ff5799c",
                  "name": "Update Customer by channel 2",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "95be62be-f983-46eb-bf7a-e07469382a20",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_oss44\"), pm.environment.get(\"secret_oss44\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "5f7263d8-e106-4f9a-9163-5dc1be24bd23",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(200, \"SUCCESS\");"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "PUT",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"firstName\": \"Jeanne\",\n\t\"lastName\": \"Moreau\",\n\t\"email\": \"jmaureau@oui.sncf\",\n\t\"phoneNumber\": \"0611111111\"\n}"
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_2}}"
                        }
                      ]
                    }
                  },
                  "response": []
                },
                {
                  "_postman_id": "c6741e32-fd40-4709-9b87-10b8eaa9288b",
                  "name": "Get updated Customer by channel 1",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "id": "445376b0-c898-41f4-9b5e-10214aae0f25",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCode(200);",
                          "",
                          "pm.test('customer phoneNumber of channel 1', function() {",
                          "    pm.expect(json.phoneNumber).to.equal(\"0610101010\");",
                          "});",
                          "",
                          "pm.test('customer externalId of channel 1', function() {",
                          "    pm.expect(json.externalId).to.equal(globals.external_id_1);",
                          "});",
                          "",
                          "pm.test('customer email of channel 1', function() {",
                          "    pm.expect(json.email).to.equal(\"cfrot@oui.sncf\");",
                          "});",
                          "",
                          "pm.test('customer firstName of channel 1', function() {",
                          "    pm.expect(json.firstName).to.equal(\"Catherine\");",
                          "});",
                          "",
                          "pm.test('customer lastName of channel 1', function() {",
                          "    pm.expect(json.lastName).to.equal(\"Frot\");",
                          "});",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "e1d87fef-2acf-49a3-b1ac-f90cdc75f49b",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_1}}"
                        }
                      ]
                    }
                  },
                  "response": []
                },
                {
                  "_postman_id": "499aea82-57ed-4f38-b43c-8f3fb84e986a",
                  "name": "Get updated Customer by channel 2",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "id": "445376b0-c898-41f4-9b5e-10214aae0f25",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCode(200);",
                          "",
                          "pm.test('customer phoneNumber of channel 1', function() {",
                          "    pm.expect(json.phoneNumber).to.equal(\"0611111111\");",
                          "});",
                          "",
                          "pm.test('customer externalId of channel 1', function() {",
                          "    pm.expect(json.externalId).to.equal(globals.external_id_1);",
                          "});",
                          "",
                          "pm.test('customer email of channel 1', function() {",
                          "    pm.expect(json.email).to.equal(\"jmaureau@oui.sncf\");",
                          "});",
                          "",
                          "pm.test('customer firstName of channel 1', function() {",
                          "    pm.expect(json.firstName).to.equal(\"Jeanne\");",
                          "});",
                          "",
                          "pm.test('customer lastName of channel 1', function() {",
                          "    pm.expect(json.lastName).to.equal(\"Moreau\");",
                          "});"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "e1d87fef-2acf-49a3-b1ac-f90cdc75f49b",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_oss44\"), pm.environment.get(\"secret_oss44\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_2}}"
                        }
                      ]
                    }
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "81392697-b548-45d4-ab52-df8152fc78d0",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "a12f1179-a786-42f9-9ae5-d167aaf6fb41",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "305906c8-896c-4fe3-8143-4e8e6e671e4e",
              "name": "Update customer without authorization",
              "description": "Faire un UPDATE pour r\u00e9cup\u00e9rer un CUSTOMER\r\n--> tester le oAuth\r\n\r\nStory: MAAS-308",
              "item": [
                {
                  "_postman_id": "678f10ce-d552-4c83-8e9b-aaf58373ebde",
                  "name": "Post new Customer",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const uniqueId = utils.getUniqueIdBasedOnDate();",
                          "pm.globals.set(\"external_id_1\", uniqueId);"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"cdeneuve@oui.sncf\",\n\t\"firstName\": \"Catherine\",\n\t\"lastName\": \"Deneuve\",\n\t\"phoneNumber\": \"0612121212\",\n\t\"externalId\": \"{{external_id_1}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers"
                  },
                  "response": []
                },
                {
                  "_postman_id": "556301f2-8b78-412d-8b06-e673224d59c0",
                  "name": "Update Customer without authorization - missing token",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "//utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndType(401, \"UNAUTHORIZED\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "auth": {
                      "type": "noauth"
                    },
                    "method": "GET",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": ""
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id_1}}"
                        }
                      ]
                    }
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "644f80d1-d6d7-41ec-8c43-dab16b4b8a54",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "9cf84048-30be-421f-8ad1-0f68992e7ef1",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "4713b91e-5306-47f6-9575-92ac29f7299b",
              "name": "Check mandatory fields of customer update",
              "description": "Faire un PUT du CUSTOMER\r\n--> tester les champs obligatoires\r\n\r\nStory: MAAS-308",
              "item": [
                {
                  "_postman_id": "a4da6d01-1372-45b2-ae13-b28d37a577cc",
                  "name": "Post new Customer",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const externalId = utils.getUniqueIdBasedOnDate();",
                          "pm.environment.set('external_id', externalId);"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"cdeneuve@oui.sncf\",\n\t\"firstName\": \"Catherine\",\n\t\"lastName\": \"Deneuve\",\n\t\"phoneNumber\": \"0612121212\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers"
                  },
                  "response": []
                },
                {
                  "_postman_id": "5edb3947-582f-41d4-8924-fab2b92402f7",
                  "name": "Update Customer with a mandatory field empty - not allowed",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "e5c40c55-4c3b-4482-8df0-625d3592c15e",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndType(400, \"BAD_REQUEST_BODY\");",
                          "",
                          "// TODO : Test d\u00e9sactiv\u00e9, \u00e0 remettre lorsque l'ano sera corrig\u00e9e",
                          "//utils.checkResponseMessage(\"\\\"lastName\\\" is not allowed to be empty\");",
                          "//pm.test.skip(\"=> BUG JIRA MAAS-xxx\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "PUT",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"\",\n\t\"firstName\": \"Alain\",\n\t\"lastName\": \"DELON\",\n\t\"phoneNumber\": \"0612345678\"\n}"
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id}}"
                        }
                      ]
                    }
                  },
                  "response": []
                },
                {
                  "_postman_id": "1e038062-ad00-4498-be0c-c68dec38b881",
                  "name": "Update Customer with all mandatory fields empty",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "e5c40c55-4c3b-4482-8df0-625d3592c15e",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.checkResponseCodeAndType(400, \"BAD_REQUEST_BODY\");",
                          "",
                          "// TODO : Test d\u00e9sactiv\u00e9, \u00e0 remettre lorsque l'ano sera corrig\u00e9e",
                          "//utils.checkResponseMessage(\"\\\"email\\\" is not allowed to be empty, \\\"firstName\\\" is not allowed to be empty, \\\"lastName\\\" is not allowed to be empty, \\\"phoneNumber\\\" is not allowed to be empty\");",
                          "//pm.test.skip(\"=> BUG JIRA MAAS-xxx\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "PUT",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"\",\n\t\"firstName\": \"\",\n\t\"lastName\": \"\",\n\t\"phoneNumber\": \"\"\n}"
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id}}"
                        }
                      ]
                    },
                    "description": "Ano en cours : MAAS-327"
                  },
                  "response": []
                },
                {
                  "_postman_id": "fc132bec-6a68-4cbb-bb84-ff932536d26d",
                  "name": "Update Customer with a mandatory field not defined",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "e5c40c55-4c3b-4482-8df0-625d3592c15e",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndType(400, \"BAD_REQUEST_BODY\");",
                          "utils.checkResponseMessage(\"[object has missing required properties ([\\\"firstName\\\"])]\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "PUT",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"adelon@oui.sncf\",\n\t\"lastName\": \"DELON\",\n\t\"phoneNumber\": \"0612345678\"\n}"
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id}}"
                        }
                      ]
                    },
                    "description": "Ano en cours : MAAS-327"
                  },
                  "response": []
                },
                {
                  "_postman_id": "6ced7c77-5fbf-49c3-9576-ea3232a90ca3",
                  "name": "Update Customer with all mandatory fields not defined",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "e5c40c55-4c3b-4482-8df0-625d3592c15e",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.checkResponseCodeAndType(400, \"BAD_REQUEST_BODY\");",
                          "",
                          "utils.checkResponseMessage('[object has missing required properties ([\\\"email\\\",\\\"firstName\\\",\\\"lastName\\\",\\\"phoneNumber\\\"])]');"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "PUT",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\n}"
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id}}"
                        }
                      ]
                    },
                    "description": "Ano en cours : MAAS-327"
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "198da16e-a190-4cf7-8db5-76c58d53f842",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "fdb912be-0117-4afa-bf2c-bc4dbec26c0c",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "0d3115af-45e2-4cb9-bedd-abd5962faf28",
              "name": "Update customer with invalid email",
              "description": "",
              "item": [
                {
                  "_postman_id": "9209cc2c-8fd9-406b-becd-5ef21499aba2",
                  "name": "Post new Customer",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                          "",
                          "const externalId = utils.getUniqueIdBasedOnDate();",
                          "pm.environment.set('external_id', externalId);"
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");"
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "POST",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"cdeneuve@oui.sncf\",\n\t\"firstName\": \"Catherine\",\n\t\"lastName\": \"Deneuve\",\n\t\"phoneNumber\": \"0612121212\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers"
                  },
                  "response": []
                },
                {
                  "_postman_id": "ef63fd5a-9490-47c3-ae45-d32bd5850882",
                  "name": "Update Customer with invalid email - error",
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                        "exec": [
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                        "exec": [
                          "const json = pm.response.json();",
                          "",
                          "const utils = eval(globals.loadUtils);",
                          "",
                          "// TODO : Test d\u00e9sactiv\u00e9, \u00e0 remettre lorsque l'ano sera corrig\u00e9e",
                          "//utils.checkResponseCodeAndType(400, \"BAD_REQUEST_BODY\");",
                          "//pm.test.skip(\"=> BUG JIRA MAAS-xxx\");",
                          "",
                          "// TODO : Test d\u00e9sactiv\u00e9, \u00e0 remettre lorsque l'ano sera corrig\u00e9e",
                          "//utils.checkResponseMessage(\"\\\"email\\\" must be a valid email\");",
                          "//pm.test.skip(\"=> BUG JIRA MAAS-xxx\");",
                          ""
                        ],
                        "type": "text/javascript"
                      }
                    }
                  ],
                  "request": {
                    "method": "PUT",
                    "header": [
                      {
                        "key": "Content-Type",
                        "value": "application/json"
                      }
                    ],
                    "body": {
                      "mode": "raw",
                      "raw": "{\n\t\"email\": \"gdepardieu_oui.sncf\",\n\t\"firstName\": \"G\u00e9rard\",\n\t\"lastName\": \"DEPARDIEU\",\n\t\"phoneNumber\": \"0611223344\",\n\t\"externalId\": \"{{external_id}}\"\n}"
                    },
                    "url": {
                      "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers/:customerId",
                      "protocol": "https",
                      "host": [
                        "api",
                        "maas-{{account}}",
                        "aws",
                        "vsct",
                        "fr"
                      ],
                      "path": [
                        "{{envName}}",
                        "customers",
                        ":customerId"
                      ],
                      "variable": [
                        {
                          "key": "customerId",
                          "value": "{{external_id}}"
                        }
                      ]
                    }
                  },
                  "response": []
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "0854aef5-7f63-4cb1-94d7-dfe57d8b8f95",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "752a812d-3ba9-4208-a020-a5c08d4247c8",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            }
          ],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4b1281c9-26da-42f6-8d0b-a824e97dabbb",
                "type": "text/javascript",
                "exec": [
                  ""
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "b3f7286e-6715-4ce1-ac02-6b346ad84245",
                "type": "text/javascript",
                "exec": [
                  ""
                ]
              }
            }
          ],
          "_postman_isSubFolder": true
        }
      ],
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "id": "637219b3-3942-426e-85ae-066fe03f37c3",
            "type": "text/javascript",
            "exec": [
              "//let utils = eval(globals.loadUtils);",
              "//utils.getToken(\"customers\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
              ""
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "id": "4cb1585c-7e54-4be5-a0b1-d2491e9ef09b",
            "type": "text/javascript",
            "exec": [
              ""
            ]
          }
        }
      ]
    },
    {
      "_postman_id": "d7de80ca-1fa0-4415-b65f-e61dcc693141",
      "name": "Search",
      "description": null,
      "item": [
        {
          "_postman_id": "f0578470-c627-4276-9b7a-a7c795c1be85",
          "name": "AroundMe",
          "description": null,
          "item": [
            {
              "_postman_id": "e9e12dcf-3821-4a49-bf20-bca1ddbe98ed",
              "name": "Smovengo",
              "description": "",
              "item": [
                {
                  "_postman_id": "409e50b9-934f-407a-9176-25cb6260b457",
                  "name": "More than 50 v\u00e9lib within 10 km from the center of Paris",
                  "description": "Appeler le service nearby avec une origin PARIS CENTRE et un radius de 10 km\r\n--> v\u00e9rifier que l'on a au moins 50 v\u00e9los \"VELIB\" qui remontent\r\n--> v\u00e9rifier que les coordonn\u00e9es de ces v\u00e9los sont bien comprises dans le radius de 10 km\r\nCe dernier test est d\u00e9sactiv\u00e9, des stations se trouvent en dehors du p\u00e9rim\u00e8tre envoy\u00e9 au service de V\u00e9lib.\r\nPour v\u00e9rifier que le radius est correctement pris en compte, le test suivant permettant de v\u00e9rifier qu'une seule station V\u00e9lib est retourn\u00e9e dans un rayon de 10m.\r\n\r\nStory converte:\r\nhttps://jira.vsct.fr/browse/MAAS-306",
                  "item": [
                    {
                      "_postman_id": "044b5702-8346-49f5-87e7-d2615bf411ce",
                      "name": "post aroundme Smovengo",
                      "event": [
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "7d66b54b-de7f-4444-a252-6c8a2c5b9418",
                            "exec": [
                              "let utils = eval(globals.loadUtils);",
                              "utils.getToken(\"search\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "test",
                          "script": {
                            "id": "d423be3a-8cda-4bcc-a629-bcbbbaf62fc0",
                            "exec": [
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "utils.checkResponseCode(201);",
                              "",
                              "pm.test(\"searchId exists\", function () {",
                              "    pm.response.to.have.jsonBody('searchId');",
                              "    pm.environment.set('searchId', json.searchId);",
                              "    pm.environment.set('get_search_retry_count', 0);",
                              "});"
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "POST",
                        "header": [
                          {
                            "key": "Content-Type",
                            "value": "application/json"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.854908,\n    \t\t\"longitude\": 2.347663\n\t\t},\n\t\t\"radius\": 10000\n}"
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/aroundme"
                      },
                      "response": [
                        {
                          "id": "712d61eb-eecb-4878-b875-5a87cfa12c88",
                          "name": "post aroundme with a 900 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 900\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        },
                        {
                          "id": "e59735a0-a144-43fd-9c6e-31e243ae0a49",
                          "name": "post aroundme with 500 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 500\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        }
                      ]
                    },
                    {
                      "_postman_id": "77497ff5-a9e8-474e-84a3-99ad73e192d7",
                      "name": "get aroundme Smovengo",
                      "event": [
                        {
                          "listen": "test",
                          "script": {
                            "id": "0c298ebc-95ca-4ce5-9c9e-9da35ce65e31",
                            "exec": [
                              "const retryCount = pm.environment.get('get_search_retry_count');",
                              "pm.environment.set('get_search_retry_count', retryCount + 1);",
                              "const responseSchema = {",
                              "  wish: 'object',",
                              "  status: 'string',",
                              "  results: 'array'",
                              "};",
                              "",
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "utils.checkResponseCode(200);",
                              "",
                              "// todo: revoir ce check",
                              "pm.test('response is valid', function() {",
                              "    pm.expect(tv4.validate(json, responseSchema)).to.be.true;",
                              "});",
                              "",
                              "if (json.status === 'IN_PROGRESS' && retryCount < 15) {",
                              "    console.log(\"IN_PROGRESS\");",
                              "",
                              "    utils.alertWhenResponseCodeNotEqualTo(200);",
                              "",
                              "    utils.sleep(1000); // wait 1 seconde",
                              "    postman.setNextRequest('get aroundme Smovengo');",
                              "",
                              "} else if (json.status === 'COMPLETE') {",
                              "",
                              "    const radius = json.wish.radius;",
                              "    const smovengoResultsLength = json.results.find(({origin}) => origin === 'smovengo').results.length;",
                              "    pm.test(`${smovengoResultsLength} smovengo results for a ${radius} meters radius (retried ${retryCount} times)`, function () {",
                              "       pm.expect(smovengoResultsLength).to.be.above(50);",
                              "    });",
                              "} else{",
                              "    tests['ERROR : Last response has a status \"NOT COMPLETE\"'] = false;",
                              "}"
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "0a4d398d-5a31-46a9-9a86-afd121d8b683",
                            "exec": [
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "GET",
                        "header": [
                          {
                            "key": "Content-Type",
                            "type": "text",
                            "value": "application/xml"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": ""
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/aroundme/{{searchId}}"
                      },
                      "response": []
                    }
                  ],
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "c277a48a-a1be-4c4f-b81d-0d2c6e022fa9",
                        "type": "text/javascript",
                        "exec": [
                          ""
                        ]
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "33a4114e-09b0-4900-862a-d13df75308bc",
                        "type": "text/javascript",
                        "exec": [
                          ""
                        ]
                      }
                    }
                  ],
                  "_postman_isSubFolder": true
                },
                {
                  "_postman_id": "dfc5c2ce-3aa6-4f45-8a7e-6ed218a0c769",
                  "name": "One velib station in a radius of 10m",
                  "description": "S\u00e9lectionner la coordonn\u00e9e d'un VELIB et appeler le service nearby avec cette coordonn\u00e9e et un radius de 10 m\r\n--> v\u00e9rifier que la station VELIB s\u00e9lectionn\u00e9e remonte bien et qu'aucune autre station ne remonte.\r\n\r\nStory converte:\r\nhttps://jira.vsct.fr/browse/MAAS-306",
                  "item": [
                    {
                      "_postman_id": "f2dcb4a3-8949-4ab3-81c7-9d20d1842eda",
                      "name": "post aroundme Smovengo 10m",
                      "event": [
                        {
                          "listen": "test",
                          "script": {
                            "id": "0c298ebc-95ca-4ce5-9c9e-9da35ce65e31",
                            "exec": [
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "utils.checkResponseCode(201);",
                              "",
                              "pm.test(\"searchId exists\", function () {",
                              "    pm.response.to.have.jsonBody('searchId');",
                              "    pm.environment.set('searchId', json.searchId);",
                              "    pm.environment.set('get_search_retry_count', 0);",
                              "});",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "0a4d398d-5a31-46a9-9a86-afd121d8b683",
                            "exec": [
                              "let utils = eval(globals.loadUtils);",
                              "utils.getToken(\"search\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "POST",
                        "header": [
                          {
                            "key": "Content-Type",
                            "name": "Content-Type",
                            "value": "application/json",
                            "type": "text"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.823933,\n    \t\t\"longitude\": 2.260691\n\t\t},\n\t\t\"radius\": 10\n}"
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/aroundme"
                      },
                      "response": [
                        {
                          "id": "5a47ea7a-f091-4f39-b67c-027d3e8ec829",
                          "name": "post aroundme with 500 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 500\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        },
                        {
                          "id": "ae07fc2d-c753-4c88-b3a3-3012a0ab51a3",
                          "name": "post aroundme with a 900 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 900\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        }
                      ]
                    },
                    {
                      "_postman_id": "522380c9-dfec-465e-ac64-b9a73a2902e9",
                      "name": "get aroundme Smovengo 10m",
                      "event": [
                        {
                          "listen": "test",
                          "script": {
                            "id": "0c298ebc-95ca-4ce5-9c9e-9da35ce65e31",
                            "exec": [
                              "const retryCount = pm.environment.get('get_search_retry_count');",
                              "pm.environment.set('get_search_retry_count', retryCount + 1);",
                              "const responseSchema = {",
                              "  wish: 'object',",
                              "  status: 'string',",
                              "  results: 'array'",
                              "};",
                              "",
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "utils.checkResponseCode(200);",
                              "",
                              "// todo: revoir ce check",
                              "pm.test('response is valid', function() {",
                              "    pm.expect(tv4.validate(json, responseSchema)).to.be.true;",
                              "});",
                              "",
                              "if (json.status === 'IN_PROGRESS' && retryCount < 15) {",
                              "    console.log(\"IN_PROGRESS\");",
                              "",
                              "    utils.alertWhenResponseCodeNotEqualTo(200);",
                              "",
                              "    utils.sleep(1000); // wait 1 seconde",
                              "    postman.setNextRequest('get aroundme Smovengo 10m');",
                              "",
                              "} else if (json.status === 'COMPLETE') {",
                              "",
                              "    const radius = json.wish.radius;",
                              "    const smovengoResultsLength = json.results.find(({origin}) => origin === 'smovengo').results.length;",
                              "    pm.test(`1 smovengo result for a 10 meters radius`, function () {",
                              "       pm.expect(smovengoResultsLength).to.equal(1);",
                              "    });",
                              "}else{",
                              "    tests['ERROR : Last response has a status \"NOT COMPLETE\"'] = false;",
                              "}"
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "0a4d398d-5a31-46a9-9a86-afd121d8b683",
                            "exec": [
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "GET",
                        "header": [
                          {
                            "key": "Content-Type",
                            "type": "text",
                            "value": "application/xml"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": ""
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/aroundme/{{searchId}}"
                      },
                      "response": []
                    }
                  ],
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "3dde4616-355e-40e9-ba99-fe468d880090",
                        "type": "text/javascript",
                        "exec": [
                          ""
                        ]
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "25770311-f576-4ac1-88dd-9b026c174948",
                        "type": "text/javascript",
                        "exec": [
                          ""
                        ]
                      }
                    }
                  ],
                  "_postman_isSubFolder": true
                }
              ],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "33e61fee-e87e-4c68-bd95-21f815e0b9c6",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "04749f1b-e705-42dd-b21b-2bc48093298b",
                    "type": "text/javascript",
                    "exec": [
                      ""
                    ]
                  }
                }
              ],
              "_postman_isSubFolder": true
            }
          ],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "134ff103-a096-4c82-b4b4-a57a6ee8a93a",
                "type": "text/javascript",
                "exec": [
                  ""
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "6a26f712-7e94-4aa7-91c6-7a74135b0511",
                "type": "text/javascript",
                "exec": [
                  ""
                ]
              }
            }
          ],
          "_postman_isSubFolder": true
        },
        {
          "_postman_id": "b318e634-37c9-48c0-aae6-8d7f452b8a95",
          "name": "Itineraries",
          "description": "",
          "item": [
            {
              "_postman_id": "99bba695-57ba-49f9-b63a-a9f9c4027158",
              "name": "Bus Direct",
              "description": "",
              "item": [
                {
                  "_postman_id": "fb92af96-a527-4f27-bb56-88d1c2760e33",
                  "name": "Bus Direct - M\u00e9tro Villiers -> A\u00e9roport d'Orly",
                  "description": "Faire un appel au service SEARCH/ITINERARIES avec :\r\nen origine : le m\u00e9tro villiers\r\nen destination : l'a\u00e9roport ORLY\r\n--> le service me remonte des itin\u00e9raires dont un segment au moins est un BUS DIRECT\r\n--> j'ai un proposalID, un label, un prix au niveau des segments BUS DIRECT",
                  "item": [
                    {
                      "_postman_id": "58f00dd3-2275-4983-8294-c07a1c30b5e7",
                      "name": "Post Itinerary Bus Direct - M\u00e9tro Villiers - A\u00e9roport Orly",
                      "event": [
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "7d66b54b-de7f-4444-a252-6c8a2c5b9418",
                            "exec": [
                              "let utils = eval(globals.loadUtils);",
                              "utils.getToken(\"search\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                              "",
                              "const moment = require('moment');",
                              "pm.environment.set('itinerary_search_date', moment().add(1, \"hours\"))",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "test",
                          "script": {
                            "id": "d423be3a-8cda-4bcc-a629-bcbbbaf62fc0",
                            "exec": [
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "utils.checkResponseCode(201);",
                              "",
                              "pm.test(\"SearchID exists\", function () {",
                              "    pm.response.to.have.jsonBody('searchId');",
                              "    pm.environment.set('searchId', json.searchId);",
                              "    pm.environment.set('get_search_retry_count', 0);",
                              "});",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "POST",
                        "header": [
                          {
                            "key": "Content-Type",
                            "value": "application/json"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": "{\n  \"origin\": {\n    \"latitude\": 48.881365,\n    \"longitude\": 2.315047\n  },\n  \"destination\": {\n    \"latitude\": 48.732702,\n    \"longitude\": 2.364299\n  },\n  \"searchDate\": \"{{itinerary_search_date}}\"\n}\n"
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/itinerary"
                      },
                      "response": [
                        {
                          "id": "6919a8bf-e3c1-4dc1-8eec-07617710dcbf",
                          "name": "post aroundme with 500 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 500\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        },
                        {
                          "id": "c02ce68c-9a8a-46cc-9671-7e1fd63a6b04",
                          "name": "post aroundme with a 900 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 900\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        }
                      ]
                    },
                    {
                      "_postman_id": "f4349a02-a9c8-4f41-a669-830cd1995579",
                      "name": "Get itinerary  Bus Direct - M\u00e9tro Villiers - A\u00e9roport Orly",
                      "event": [
                        {
                          "listen": "test",
                          "script": {
                            "id": "0c298ebc-95ca-4ce5-9c9e-9da35ce65e31",
                            "exec": [
                              "const retryCount = pm.environment.get('get_search_retry_count');",
                              "pm.environment.set('get_search_retry_count', retryCount + 1);",
                              "",
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "const itineraryUtils = eval(globals.itineraryUtils);",
                              "",
                              "",
                              "if (json.status === 'IN_PROGRESS' && retryCount < 20) {",
                              "    console.log(\"IN_PROGRESS\");",
                              "",
                              "    utils.alertWhenResponseCodeNotEqualTo(200);",
                              "",
                              "    utils.sleep(1000); // wait 1 seconde",
                              "    postman.setNextRequest('Get itinerary  Bus Direct - M\u00e9tro Villiers - A\u00e9roport Orly');",
                              "",
                              "} else if (json.status === 'COMPLETE') {",
                              "    console.log(\"COMPLETE\");",
                              "",
                              "    // label: \"LE BUS DIRECT 1 : A\u00c9ROPORT ORLY <=> PARIS \u00c9TOILE / CHAMPS-\u00c9LYS\u00c9ES\",",
                              "    itineraryUtils.assertItineraries({",
                              "        label: \"LE BUS DIRECT \",",
                              "        amount: 600",
                              "    });",
                              "",
                              "}",
                              "else{",
                              "    tests['ERROR : Last response has a status \"NOT COMPLETE\"'] = false;",
                              "}",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "0a4d398d-5a31-46a9-9a86-afd121d8b683",
                            "exec": [
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "GET",
                        "header": [
                          {
                            "key": "Content-Type",
                            "type": "text",
                            "value": "application/xml"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": ""
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/itinerary/{{searchId}}"
                      },
                      "response": []
                    }
                  ],
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "ca641b9a-10a2-40af-bb0c-bbb5c704c148",
                        "type": "text/javascript",
                        "exec": [
                          ""
                        ]
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "c826a2e1-5ce8-4a56-9e99-a0eeafb828b1",
                        "type": "text/javascript",
                        "exec": [
                          ""
                        ]
                      }
                    }
                  ],
                  "_postman_isSubFolder": true
                },
                {
                  "_postman_id": "272d76a9-81fc-4b99-b44e-d1e70be3c6a9",
                  "name": "Bus Direct - M\u00e9tro Villiers -> A\u00e9roport CDG",
                  "description": "Faire un appel au service SEARCH/ITINERARIES avec :\r\nen origine : le m\u00e9tro villiers\r\nen destination : CDG\r\n--> le service me remonte des itin\u00e9raires dont un segment au moins est un BUS DIRECT\r\n--> j'ai un proposalID, un label, un prix au niveau des segments BUS DIRECT",
                  "item": [
                    {
                      "_postman_id": "a2c2965d-c8a9-4e29-93a0-f59f3c85211e",
                      "name": "Post Itinerary Bus Direct - M\u00e9tro Villiers - A\u00e9roport CDG",
                      "event": [
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "7d66b54b-de7f-4444-a252-6c8a2c5b9418",
                            "exec": [
                              "let utils = eval(globals.loadUtils);",
                              "utils.getToken(\"search\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                              "",
                              "const moment = require('moment');",
                              "pm.environment.set('itinerary_search_date', moment().add(1, \"hours\"))"
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "test",
                          "script": {
                            "id": "d423be3a-8cda-4bcc-a629-bcbbbaf62fc0",
                            "exec": [
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "utils.checkResponseCode(201);",
                              "",
                              "pm.test(\"post response is valid\", function () {",
                              "    pm.response.to.have.jsonBody('searchId');",
                              "    pm.environment.set('searchId', json.searchId);",
                              "    pm.environment.set('get_search_retry_count', 0);",
                              "});",
                              "",
                              "function sleep(millis)",
                              " {",
                              "  var date = new Date();",
                              "  var curDate = null;",
                              "  do { curDate = new Date(); }",
                              "  while(curDate-date < millis);",
                              "}",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "POST",
                        "header": [
                          {
                            "key": "Content-Type",
                            "value": "application/json"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": "{\n  \"origin\": {\n    \"latitude\": 48.881365,\n    \"longitude\": 2.315047\n  },\n  \"destination\": {\n    \"latitude\": 49.022331,\n    \"longitude\": 2.549546\n  },\n  \"searchDate\": \"{{itinerary_search_date}}\"\n}\n"
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/itinerary"
                      },
                      "response": [
                        {
                          "id": "16aff2b8-616c-4bdd-83c8-02f641aebc12",
                          "name": "post aroundme with a 900 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 900\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        },
                        {
                          "id": "b746230b-13d6-49b4-9f60-aa17d8799270",
                          "name": "post aroundme with 500 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 500\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        }
                      ]
                    },
                    {
                      "_postman_id": "813b732e-4aa5-4042-b3de-3bcf5f320585",
                      "name": "Get itinerary Bus Direct - M\u00e9tro Villiers - A\u00e9roport CDG",
                      "event": [
                        {
                          "listen": "test",
                          "script": {
                            "id": "0c298ebc-95ca-4ce5-9c9e-9da35ce65e31",
                            "exec": [
                              "const retryCount = pm.environment.get('get_search_retry_count');",
                              "pm.environment.set('get_search_retry_count', retryCount + 1);",
                              "",
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "const itineraryUtils = eval(globals.itineraryUtils);",
                              "",
                              "",
                              "if (json.status === 'IN_PROGRESS' && retryCount < 20) {",
                              "    console.log(\"IN_PROGRESS\");",
                              "",
                              "    utils.alertWhenResponseCodeNotEqualTo(200);",
                              "",
                              "    utils.sleep(1000); // wait 1 seconde",
                              "    postman.setNextRequest('Get itinerary Bus Direct - M\u00e9tro Villiers - A\u00e9roport CDG');",
                              "",
                              "} else if (json.status === 'COMPLETE') {",
                              "    console.log(\"COMPLETE\");",
                              "/*",
                              "    utils.checkResponseCode(200);",
                              "",
                              "    pm.test('Has at least one string \"BUS DIRECT\" in the formatted text response', function () {",
                              "        pm.expect(pm.response.text()).to.include(\"BUS_DIRECT\");",
                              "    });",
                              "",
                              "",
                              "    const busDirectResult = json.results.find(({segments}) => segments.find(({partner}) => partner === 'BUS_DIRECT'));",
                              "    pm.test('Has at least one BUS DIRECT result', function () {",
                              "        pm.expect(busDirectResult).to.not.be.null;",
                              "    });",
                              "",
                              "",
                              "    // Check values from this segment\"",
                              "",
                              "    const segmentBusDirect = busDirectResult.segments.find(({partner}) => partner === 'BUS_DIRECT');",
                              "",
                              "    pm.test('Check Segment BUS_DIRECT label', function () {",
                              "        const label = segmentBusDirect.label;",
                              "        pm.expect(label).to.not.be.null;",
                              "        pm.expect(label).to.equal(\"LE BUS DIRECT 2 : A\u00c9ROPORT CDG <=> PARIS TOUR EIFFEL\"); // Surveiller le taux de maintenance de cette v\u00e9rif",
                              "        //pm.expect(label).to.be.oneOf([\"LE BUS DIRECT 2 : A\u00c9ROPORT CDG <=> PARIS TOUR EIFFEL\", \"LE BUS DIRECT 4 : A\u00c9ROPORT CDG <=> PARIS GARE MONTPARNASSE\"]);",
                              "    });",
                              "",
                              "    pm.test('Check Segment BUS_DIRECT proposal.id', function () {",
                              "        const proposalId = segmentBusDirect.proposals[0].id;",
                              "        pm.expect(proposalId).to.not.be.null;",
                              "        pm.expect(proposalId).to.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/);",
                              "    });",
                              "",
                              "    pm.test('Check Segment BUS_DIRECT proposal.price', function () {",
                              "        const proposalPrice = segmentBusDirect.proposals[0].price;",
                              "        pm.expect(proposalPrice).to.not.be.null;",
                              "        pm.expect(proposalPrice).to.equal(9);",
                              "    });",
                              "*/",
                              "",
                              "    //label : \"LE BUS DIRECT 2 : A\u00c9ROPORT CDG <=> PARIS TOUR EIFFEL\",",
                              "    itineraryUtils.assertItineraries({",
                              "        label : \"LE BUS DIRECT \",",
                              "        amount : 900",
                              "    });",
                              "",
                              "}else{",
                              "    tests['ERROR : Last response has a status \"NOT COMPLETE\"'] = false;",
                              "}",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "0a4d398d-5a31-46a9-9a86-afd121d8b683",
                            "exec": [
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "GET",
                        "header": [
                          {
                            "key": "Content-Type",
                            "type": "text",
                            "value": "application/xml"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": ""
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/itinerary/{{searchId}}"
                      },
                      "response": []
                    }
                  ],
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "ca641b9a-10a2-40af-bb0c-bbb5c704c148",
                        "type": "text/javascript",
                        "exec": [
                          ""
                        ]
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "c826a2e1-5ce8-4a56-9e99-a0eeafb828b1",
                        "type": "text/javascript",
                        "exec": [
                          ""
                        ]
                      }
                    }
                  ],
                  "_postman_isSubFolder": true
                },
                {
                  "_postman_id": "2fa142e1-0937-4772-9845-ddfda8b76f1a",
                  "name": "No Bus Direct to Marseille Saint-Charles",
                  "description": "Faire un appel au service SEARCH/ITINERARIES avec :\nen origine : le m\u00e9tro villiers\nen destination : Marseille Saint Charles\n--> aucune appel \u00e0 CMI n'est r\u00e9alis\u00e9",
                  "item": [
                    {
                      "_postman_id": "c9b45040-1e27-49fa-98fc-7f2d8c56310e",
                      "name": "Post Itinerary Bus Direct - M\u00e9tro Villiers > Marseilles Saint-Charles",
                      "event": [
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "7d66b54b-de7f-4444-a252-6c8a2c5b9418",
                            "exec": [
                              "let utils = eval(globals.loadUtils);",
                              "utils.getToken(\"search\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                              "",
                              "const moment = require('moment');",
                              "pm.environment.set('itinerary_search_date', moment().add(1, \"hours\"))",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "test",
                          "script": {
                            "id": "d423be3a-8cda-4bcc-a629-bcbbbaf62fc0",
                            "exec": [
                              "const json = pm.response.json();",
                              "const utils = eval(globals.loadUtils);",
                              "",
                              "utils.checkResponseCode(201);",
                              "",
                              "pm.test(\"post response is valid\", function () {",
                              "    pm.response.to.have.jsonBody('searchId');",
                              "    pm.environment.set('searchId', json.searchId);",
                              "    pm.environment.set('get_search_retry_count', 0);",
                              "});",
                              "",
                              "utils.sleep(2000);"
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "POST",
                        "header": [
                          {
                            "key": "Content-Type",
                            "value": "application/json"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": "{\n  \"origin\": {\n    \"latitude\": 48.881365,\n    \"longitude\": 2.315047\n  },\n  \"destination\": {\n    \"latitude\": 43.303730,\n    \"longitude\": 5.380142\n  },\n  \"searchDate\": \"{{itinerary_search_date}}\"\n}\n"
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/itinerary"
                      },
                      "response": [
                        {
                          "id": "e4980f1a-69ee-43c9-a51e-c7209bff4b90",
                          "name": "post aroundme with a 900 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 900\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        },
                        {
                          "id": "ea99822c-a6bd-4e31-87fb-ff059c7704fc",
                          "name": "post aroundme with 500 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 500\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        }
                      ]
                    },
                    {
                      "_postman_id": "aae19502-1f5e-44c2-8460-2fbcf04e7953",
                      "name": "Get Itinerary Bus Direct - M\u00e9tro Villiers > Marseilles Saint-Charles",
                      "event": [
                        {
                          "listen": "test",
                          "script": {
                            "id": "0c298ebc-95ca-4ce5-9c9e-9da35ce65e31",
                            "exec": [
                              "const retryCount = pm.environment.get('get_search_retry_count');",
                              "pm.environment.set('get_search_retry_count', retryCount + 1);",
                              "",
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "",
                              "",
                              "if (json.status === 'IN_PROGRESS' && retryCount < 20) {",
                              "    console.log(\"IN_PROGRESS\");",
                              "",
                              "    utils.alertWhenResponseCodeNotEqualTo(200);",
                              "",
                              "    utils.sleep(1000); // wait 1 seconde",
                              "    postman.setNextRequest('Get Itinerary Bus Direct - M\u00e9tro Villiers > Marseilles Saint-Charles');",
                              "",
                              "} else if (json.status === 'COMPLETE') {",
                              "    console.log(\"COMPLETE\");",
                              "",
                              "    utils.checkResponseCode(200);",
                              "",
                              "    const busDirectResult = json.results.find(({segments}) => segments.find(({partner}) => partner === 'BUS_DIRECT'));",
                              "    pm.test('No BUS DIRECT result', function () {",
                              "        pm.expect(busDirectResult).to.be.undefined;",
                              "    });",
                              "",
                              "}else{",
                              "    tests['ERROR : Last response has a status \"NOT COMPLETE\"'] = false;",
                              "}",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "0a4d398d-5a31-46a9-9a86-afd121d8b683",
                            "exec": [
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "GET",
                        "header": [
                          {
                            "key": "Content-Type",
                            "type": "text",
                            "value": "application/xml"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": ""
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/itinerary/{{searchId}}"
                      },
                      "response": []
                    }
                  ],
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "9401f53f-a95c-4541-8be4-c756ed54f1ac",
                        "type": "text/javascript",
                        "exec": [
                          ""
                        ]
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "ae23a957-510e-41a2-8b1b-2132d9aa25eb",
                        "type": "text/javascript",
                        "exec": [
                          ""
                        ]
                      }
                    }
                  ],
                  "_postman_isSubFolder": true
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "ff6cc70c-2da4-46f6-98a8-045f307fd715",
              "name": "Karhoo",
              "description": "",
              "item": [
                {
                  "_postman_id": "70344bcd-b93a-4b62-bdae-d3a362e002e3",
                  "name": "Karhoo - La D\u00e9fense -> Gare de Lyon",
                  "description": "",
                  "item": [
                    {
                      "_postman_id": "d8e13492-0048-4dff-8444-b1d89de98c3d",
                      "name": "Post Itinerary Karhoo La D\u00e9fense - Gare de Lyon",
                      "event": [
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "7d66b54b-de7f-4444-a252-6c8a2c5b9418",
                            "exec": [
                              "let utils = eval(globals.loadUtils);",
                              "utils.getToken(\"search\", pm.environment.get(\"clientId_appSncf\"), pm.environment.get(\"secret_appSncf\"));",
                              "",
                              "const moment = require('moment');",
                              "pm.environment.set('itinerary_search_date', moment().add(1, \"hours\"))",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "test",
                          "script": {
                            "id": "d423be3a-8cda-4bcc-a629-bcbbbaf62fc0",
                            "exec": [
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "utils.checkResponseCode(201);",
                              "",
                              "pm.test(\"SearchID exists\", function () {",
                              "    pm.response.to.have.jsonBody('searchId');",
                              "    pm.environment.set('searchId', json.searchId);",
                              "    pm.environment.set('get_search_retry_count', 0);",
                              "});",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "POST",
                        "header": [
                          {
                            "key": "Content-Type",
                            "value": "application/json"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": "{\n  \"origin\": {\n    \"latitude\": 48.89143,\n    \"longitude\": 2.239610\n  },\n  \"destination\": {\n    \"latitude\": 48.844982,\n    \"longitude\": 2.373084\n  },\n  \"searchDate\": \"{{itinerary_search_date}}\"\n}"
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/itinerary"
                      },
                      "response": [
                        {
                          "id": "0d36a575-f64e-4ec5-b985-5f3f400e5c80",
                          "name": "post aroundme with a 900 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 900\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        },
                        {
                          "id": "15ec1c16-3d23-4ce4-aa23-5a0a18f5b5f7",
                          "name": "post aroundme with 500 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 500\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        }
                      ]
                    },
                    {
                      "_postman_id": "82bbc5f5-9ec6-47f8-b880-2c05de8ba9f1",
                      "name": "Get itinerary Karhoo La D\u00e9fense - Gare de Lyon",
                      "event": [
                        {
                          "listen": "test",
                          "script": {
                            "id": "0c298ebc-95ca-4ce5-9c9e-9da35ce65e31",
                            "exec": [
                              "const retryCount = pm.environment.get('get_search_retry_count');",
                              "pm.environment.set('get_search_retry_count', retryCount + 1);",
                              "",
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "const itineraryUtils = eval(globals.itineraryUtils);",
                              "",
                              "",
                              "if (json.status === 'IN_PROGRESS' && retryCount < 20) {",
                              "    console.log(\"IN_PROGRESS\");",
                              "",
                              "    utils.alertWhenResponseCodeNotEqualTo(200);",
                              "",
                              "    utils.sleep(1000); // wait 1 seconde",
                              "    postman.setNextRequest('Get itinerary Karhoo La D\u00e9fense - Gare de Lyon');",
                              "",
                              "} else if (json.status === 'COMPLETE') {",
                              "    console.log(\"COMPLETE\");",
                              "",
                              "    utils.checkResponseCode(200);",
                              "",
                              "    const karhooProposals = itineraryUtils.getProposalForPartner(json, 'KARHOO');",
                              "",
                              "    pm.test('Has at least one KARHOO result', function () {",
                              "        pm.expect(karhooProposals).to.have.lengthOf.at.least(1);",
                              "    });",
                              "",
                              "    const karhooProposal = karhooProposals[0];",
                              "    const proposalSchema = itineraryUtils.proposalSchema;",
                              "",
                              "    pm.test('Check KARHOO proposals schemas', function () {",
                              "        itineraryUtils.checkProposalSchemas(karhooProposals, proposalSchema);",
                              "    });",
                              "",
                              "    pm.test('Check Segment KARHOO proposal.price', function () {",
                              "        const proposalPrice = karhooProposal.price;",
                              "        pm.expect(proposalPrice).to.not.be.null;",
                              "        pm.expect(proposalPrice.type).to.equal('ESTIMATED');",
                              "        pm.expect(proposalPrice.currency).to.equal('EUR');",
                              "        pm.expect(proposalPrice.amount).to.above(100); // 1 euro",
                              "    });",
                              "}",
                              "else{",
                              "    tests['ERROR : Last response has a status \"NOT COMPLETE\"'] = false;",
                              "}",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "0a4d398d-5a31-46a9-9a86-afd121d8b683",
                            "exec": [
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "GET",
                        "header": [
                          {
                            "key": "Content-Type",
                            "type": "text",
                            "value": "application/xml"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": ""
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/itinerary/{{searchId}}"
                      },
                      "response": []
                    }
                  ],
                  "_postman_isSubFolder": true
                }
              ],
              "_postman_isSubFolder": true
            }
          ],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "dca0b662-8084-4c4f-9048-066bb1c0b590",
                "type": "text/javascript",
                "exec": [
                  "",
                  " postman.setGlobalVariable(\"itineraryUtils\", function loadItineraryUtils() {",
                  "    return {",
                  "",
                  "        assertItineraries: function(expectations) {",
                  "",
                  "            utils.checkResponseCode(200);",
                  "",
                  "            const busDirectProposals = _.chain(json.results)",
                  "                .map(({segments}) => segments)",
                  "                .flatten()",
                  "                .map(({proposals}) => proposals)",
                  "                .flatten()",
                  "                .filter(r => r)",
                  "                .filter(({partner}) => partner === 'BUS_DIRECT')",
                  "                .value();",
                  "            ",
                  "            pm.test('Has at least one BUS DIRECT result', function () {",
                  "                pm.expect(busDirectProposals).to.have.lengthOf.at.least(1);",
                  "            });",
                  "",
                  "            const busDirectProposal = busDirectProposals[0];",
                  "",
                  "            pm.test('Check Segment BUS_DIRECT label', function () {",
                  "                const label = busDirectProposal.label;",
                  "                pm.expect(label).to.not.be.null;",
                  "                //pm.expect(label).to.equal(expectations.label);",
                  "                pm.expect(label).to.include(expectations.label);",
                  "                //pm.expect(label).to.equal(\"LE BUS DIRECT 1 : A\u00c9ROPORT ORLY <=> PARIS \u00c9TOILE / CHAMPS-\u00c9LYS\u00c9ES\");",
                  "            });",
                  "        ",
                  "            pm.test('Check Segment BUS_DIRECT proposal.id', function () {",
                  "                const proposalId = busDirectProposal.id;",
                  "                pm.expect(proposalId).to.not.be.null;",
                  "                pm.expect(proposalId).to.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/);",
                  "            });",
                  "        ",
                  "            pm.test('Check Segment BUS_DIRECT proposal.price', function () {",
                  "                const proposalPrice = busDirectProposal.price;",
                  "                pm.expect(proposalPrice).to.not.be.null;",
                  "                pm.expect(proposalPrice).to.deep.equal({amount: expectations.amount, type: 'FIXED', currency: 'EUR'});",
                  "                //pm.expect(proposalPrice).to.deep.equal({amount: 6, type: 'FIXED', currency: 'EUR'});",
                  "            });",
                  "        },",
                  "",
                  "        getProposalForPartner: function(json, partner2){",
                  "            return _.chain(json.results)",
                  "            .map(({segments}) => segments)",
                  "            .flatten()",
                  "            .map(({proposals}) => proposals)",
                  "            .flatten()",
                  "            .filter(r => r)",
                  "            .filter(({partner}) => partner === partner2)",
                  "            .value();",
                  "        },",
                  "",
                  "        checkProposalSchema: function(proposalJson, proposalSchema){",
                  "            var res = tv4.validateMultiple(proposalJson, proposalSchema);",
                  "            var resText = \"Schema checked with SUCCESS\";",
                  "            if(res.valid === false){",
                  "                resText = res.errors[0].message;",
                  "            }",
                  "            tests[resText] = res.valid;",
                  "            pm.expect(res.valid).to.be.true;",
                  "        },",
                  "",
                  "        checkProposalSchemas: function(proposalsArrayJson, proposalSchema){",
                  "            let res;",
                  "            let resText;",
                  "            let proposalNumber = 0;",
                  "            let valid = true;",
                  "            proposalsArrayJson.forEach(function(element) {",
                  "                proposalNumber++;",
                  "                res = tv4.validateMultiple(element, proposalSchema);",
                  "                resText = \"Schema checked with SUCCESS\";",
                  "                if(res.valid === false){",
                  "                    resText = res.errors[0].message;",
                  "                    valid = false;",
                  "                }",
                  "                tests['proposal ' + proposalNumber +  ' : ' + resText] = res.valid;",
                  "            });",
                  "            pm.expect(valid).to.be.true;",
                  "        },",
                  "",
                  "        proposalSchema: {",
                  "            \"required\" : [ \"partner\", \"price\", \"id\", \"label\", \"validity\", \"carWithDriverAttributes\", \"fares\"],",
                  "            \"properties\": {",
                  "                \"partner\": {",
                  "                    \"type\": \"string\",",
                  "                    \"value\": \"KARHOO\"",
                  "                },",
                  "                \"price\": {",
                  "                    \"$ref\": \"#/definitions/price\"",
                  "                },",
                  "                \"id\": {",
                  "                    \"type\": \"string\",",
                  "                    \"pattern\": \"^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$\",",
                  "                    \"examples\": \"4fed776f-7803-4742-b7e0-5ea6d330b218\"",
                  "                },",
                  "                \"label\": {",
                  "                    \"type\": \"string\"",
                  "                },",
                  "                \"validity\": {",
                  "                    \"type\": \"string\"",
                  "                },",
                  "                \"carWithDriverAttributes\": {",
                  "                    \"$ref\": \"#/definitions/carWithDriverAttributes\"",
                  "                },",
                  "                \"fares\": {",
                  "                    \"type\": \"array\",",
                  "                    \"items\": [",
                  "                        { \"$ref\": \"#/definitions/fares\" }",
                  "                    ]",
                  "                }",
                  "            },",
                  "            \"definitions\" : {",
                  "                \"carWithDriverAttributes\" : {",
                  "                    \"type\" : \"object\",",
                  "                    \"required\" : [\"passengerCapacity\", \"childSeat\", \"luggageCapacity\", \"hybrid\", \"electric\"],",
                  "                    \"properties\" : {",
                  "                        \"passengerCapacity\" : { \"type\" : \"integer\" },",
                  "                        \"childSeat\" : { \"type\" : \"boolean\" },",
                  "                        \"luggageCapacity\" : { \"type\" : \"integer\" },",
                  "                        \"hybrid\" : { \"type\" : \"boolean\" },",
                  "                        \"electric\" : { \"type\" : \"boolean\" }",
                  "                    }",
                  "                },",
                  "                \"fares\" : {",
                  "                    \"type\" : \"object\",",
                  "                    \"required\" : [\"passengerIds\", \"label\", \"price\", \"bookingData\"],",
                  "                    \"properties\" : {",
                  "                        \"passengerIds\" : {",
                  "                            \"type\" : \"array\",",
                  "                            \"items\": [",
                  "                                { \"$ref\": \"#/definitions/passengerIds\" }",
                  "                            ]",
                  "                        },",
                  "                        \"label\" : { \"type\" : \"string\" },",
                  "                        \"price\" : {",
                  "                            \"$ref\": \"#/definitions/price\"",
                  "                        },",
                  "                        \"bookingData\" : { \"type\" : \"object\" }",
                  "                    }",
                  "                },",
                  "                \"passengerIds\" : {",
                  "                    \"type\" : \"integer\"",
                  "                },",
                  "                \"price\" : {",
                  "                    \"type\" : \"object\",",
                  "                    \"required\" : [ \"type\", \"amount\", \"currency\"],",
                  "                    \"properties\" : {",
                  "                        \"type\" : { \"type\" : \"string\"},",
                  "                        \"amount\" : { \"type\" : \"integer\"},",
                  "                        \"currency\" : { \"type\" : \"string\"}",
                  "                    }",
                  "                },",
                  "                \"bookingData\" : {",
                  "                    \"type\" : \"object\",",
                  "                    \"required\" : [ \"quoteId\"],",
                  "                    \"properties\" : {",
                  "                        \"quoteId\" : { \"type\" : \"string\"}",
                  "                    }",
                  "                }",
                  "            }",
                  "        }",
                  "    };",
                  "} + '; loadItineraryUtils();');",
                  ""
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "eb2d606e-0a48-48af-830a-df610187bd38",
                "type": "text/javascript",
                "exec": [
                  ""
                ]
              }
            }
          ],
          "_postman_isSubFolder": true
        }
      ],
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "id": "405f62c8-6097-4dbc-881a-06031fc05da7",
            "type": "text/javascript",
            "exec": [
              "//let utils = eval(globals.loadUtils);",
              "//utils.getToken(\"search\", pm.environment.get(\"clientId\"), pm.environment.get(\"secret\"));"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "id": "30ef9bce-739d-463e-8b94-e70aa2ed30d1",
            "type": "text/javascript",
            "exec": [
              ""
            ]
          }
        }
      ]
    },
    {
      "_postman_id": "da9d9257-a008-4230-a30a-b8c3e614556b",
      "name": "Order",
      "description": "",
      "item": [
        {
          "_postman_id": "906390ca-22d2-49a0-a006-835c4a3bff5f",
          "name": "Bus Direct",
          "description": "",
          "item": [
            {
              "_postman_id": "b69127bb-9af1-415d-9d80-52100aba6390",
              "name": "Create Order",
              "description": "",
              "item": [
                {
                  "_postman_id": "00660098-bb39-4a89-8aef-f48de9a9430e",
                  "name": "Create Order - Customer without Card",
                  "description": "",
                  "item": [
                    {
                      "_postman_id": "c94b19a3-fa3a-49bb-a19f-38206520edf2",
                      "name": "Order - Post new Customer",
                      "event": [
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                            "exec": [
                              "const utils = eval(globals.loadUtils);",
                              "",
                              "utils.getToken(\"customers\", pm.environment.get(\"clientId\"), pm.environment.get(\"secret\"));",
                              "",
                              "const uniqueId = utils.getUniqueIdBasedOnDate();",
                              "pm.variables.set('uniqueId', uniqueId)",
                              "pm.environment.set('customerId', uniqueId);"
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "test",
                          "script": {
                            "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                            "exec": [
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");"
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "POST",
                        "header": [
                          {
                            "key": "Content-Type",
                            "value": "application/json"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": "{\n\t\"email\": \"fcabrel@oui.sncf{{uniqueId}}\",\n\t\"firstName\": \"Francis{{uniqueId}}\",\n\t\"lastName\": \"CABREL{{uniqueId}}\",\n\t\"phoneNumber\": \"0687654321{{uniqueId}}\",\n\t\"externalId\": \"{{customerId}}\"\n}"
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers"
                      },
                      "response": []
                    },
                    {
                      "_postman_id": "a41a7caf-c6fb-44c8-a17e-0b31500122fc",
                      "name": "Order - Post Itinerary M\u00e9tro Villiers - A\u00e9roport Orly",
                      "event": [
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "7d66b54b-de7f-4444-a252-6c8a2c5b9418",
                            "exec": [
                              "let utils = eval(globals.loadUtils);",
                              "utils.getToken(\"search\", pm.environment.get(\"clientId\"), pm.environment.get(\"secret\"));",
                              "",
                              "const moment = require('moment');",
                              "pm.environment.set('itinerary_search_date', moment().add(1, \"hours\"))",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "test",
                          "script": {
                            "id": "d423be3a-8cda-4bcc-a629-bcbbbaf62fc0",
                            "exec": [
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "utils.checkResponseCode(201);",
                              "",
                              "pm.test(\"SearchID exists\", function () {",
                              "    pm.response.to.have.jsonBody('searchId');",
                              "    pm.environment.set('searchId', json.searchId);",
                              "    pm.environment.set('get_search_retry_count', 0);",
                              "});",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "POST",
                        "header": [
                          {
                            "key": "Content-Type",
                            "value": "application/json"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": "{\n  \"origin\": {\n    \"latitude\": 48.881365,\n    \"longitude\": 2.315047\n  },\n  \"destination\": {\n    \"latitude\": 48.732702,\n    \"longitude\": 2.364299\n  },\n  \"searchDate\": \"{{itinerary_search_date}}\",\n  \"passengers\": [\n            {\n                \"birthDate\": \"2001-01-23\",\n                \"id\": \"toto\"\n            }\n        ]\n}\n"
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/itinerary"
                      },
                      "response": [
                        {
                          "id": "10cc044c-87a1-4a95-8f4c-4de19b801dff",
                          "name": "post aroundme with a 900 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 900\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        },
                        {
                          "id": "2fa03909-56b1-4f46-bb4a-b75255856145",
                          "name": "post aroundme with 500 meter radius",
                          "originalRequest": {
                            "method": "POST",
                            "header": [
                              {
                                "key": "Content-Type",
                                "value": "application/json"
                              }
                            ],
                            "body": {
                              "mode": "raw",
                              "raw": "{\n\t\t\"origin\": {\n\t\t\t\"latitude\": 48.8585,\n    \t\t\"longitude\": 2.348\n\t\t},\n\t\t\"radius\": 500\n}"
                            },
                            "url": "https://api.maas-dev.aws.vsct.fr/{{envName}}/search/aroundme"
                          },
                          "status": "Created",
                          "code": 201,
                          "_postman_previewlanguage": "json",
                          "header": [
                            {
                              "key": "Content-Type",
                              "value": "application/json"
                            },
                            {
                              "key": "Content-Length",
                              "value": "51"
                            },
                            {
                              "key": "Connection",
                              "value": "keep-alive"
                            },
                            {
                              "key": "Date",
                              "value": "Mon, 19 Nov 2018 16:50:58 GMT"
                            },
                            {
                              "key": "x-amzn-RequestId",
                              "value": "4a016e50-ec1b-11e8-94d1-b178167004b6"
                            },
                            {
                              "key": "Access-Control-Allow-Origin",
                              "value": "*"
                            },
                            {
                              "key": "Access-Control-Allow-Headers",
                              "value": "*"
                            },
                            {
                              "key": "x-amz-apigw-id",
                              "value": "Qnl94ETvjoEF3Zg="
                            },
                            {
                              "key": "X-Amzn-Trace-Id",
                              "value": "Root=1-5bf2e9f2-fa263c8eaa8f9940adf22498;Sampled=0"
                            },
                            {
                              "key": "X-Cache",
                              "value": "Miss from cloudfront"
                            },
                            {
                              "key": "Via",
                              "value": "1.1 d0d375ba56c1f10e9a2e4f9e02955d03.cloudfront.net (CloudFront)"
                            },
                            {
                              "key": "X-Amz-Cf-Id",
                              "value": "S44NfyfAqQ8cQ2X8I7s6b0QZQJY_Cf_k6yF3_hopM8PL0DCFYIzsLg=="
                            }
                          ],
                          "cookie": [],
                          "responseTime": null,
                          "body": "{\n    \"searchId\": \"a7777f75-6464-4528-b798-b7cc743fdeca\"\n}"
                        }
                      ]
                    },
                    {
                      "_postman_id": "a6f90dea-2a71-492a-9fe0-68c471a9022b",
                      "name": "Order - Get itinerary M\u00e9tro Villiers - A\u00e9roport Orly",
                      "event": [
                        {
                          "listen": "test",
                          "script": {
                            "id": "0c298ebc-95ca-4ce5-9c9e-9da35ce65e31",
                            "exec": [
                              "const retryCount = pm.environment.get('get_search_retry_count');",
                              "pm.environment.set('get_search_retry_count', retryCount + 1);",
                              "",
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "const itineraryUtils = eval(globals.itineraryUtils);",
                              "",
                              "",
                              "if (json.status === 'IN_PROGRESS' && retryCount < 50) {",
                              "    console.log(\"IN_PROGRESS\");",
                              "",
                              "    utils.alertWhenResponseCodeNotEqualTo(200);",
                              "",
                              "    utils.sleep(1000); // wait 1 seconde",
                              "    postman.setNextRequest('Order - Get itinerary M\u00e9tro Villiers - A\u00e9roport Orly');",
                              "",
                              "} else if (json.status === 'COMPLETE') {",
                              "    console.log(\"COMPLETE\");",
                              "",
                              "    const busDirectProposals = _.chain(json.results)",
                              "        .map(({segments}) => segments)",
                              "        .flatten()",
                              "        .map(({proposals}) => proposals)",
                              "        .flatten()",
                              "        .filter(r => r)",
                              "        .filter(({partner}) => partner === 'BUS_DIRECT')",
                              "        .value();",
                              "    ",
                              "    if (busDirectProposals.length === 0) {",
                              "        tests['ERROR : No bus direct proposal'] = false;",
                              "    } else {",
                              "        pm.environment.set('proposalId', busDirectProposals[0].id);",
                              "    }",
                              "}",
                              "else{",
                              "    tests['ERROR : Last response has a status \"NOT COMPLETE\"'] = false;",
                              "}",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "0a4d398d-5a31-46a9-9a86-afd121d8b683",
                            "exec": [
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "GET",
                        "header": [
                          {
                            "key": "Content-Type",
                            "type": "text",
                            "value": "application/xml"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": ""
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/search/itinerary/{{searchId}}"
                      },
                      "response": []
                    },
                    {
                      "_postman_id": "ff17039d-109c-4156-8a36-224c349ea014",
                      "name": "Order - Post Order",
                      "event": [
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "cf9587e9-5dd3-425a-87a6-ac1f44ed4298",
                            "exec": [
                              "const utils = eval(globals.loadUtils);",
                              "utils.getToken(\"orders\", pm.environment.get(\"clientId\"), pm.environment.get(\"secret\"));"
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "test",
                          "script": {
                            "id": "86fae201-1777-4c49-b2c0-1a2954ea1904",
                            "exec": [
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "utils.checkResponseCode(201);",
                              "",
                              "pm.test(\"Order id in response\", function () {",
                              "    const orderId = json.orderId;",
                              "    pm.expect(orderId).to.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/);",
                              "    pm.environment.set(\"orderId\", orderId);",
                              "});",
                              "",
                              "pm.test(\"Billet in response\", function () {",
                              "    const ebillet = json.transactions[0].partnerSpecificAttributes.ebillet;",
                              "    pm.expect(ebillet).to.match(/^[0-9]{38}$/);",
                              "});",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "POST",
                        "header": [
                          {
                            "key": "Content-Type",
                            "value": "application/json"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": "{\n  \"customerId\": \"{{customerId}}\",\n  \"searchId\": \"{{searchId}}\",\n  \"proposalId\": \"{{proposalId}}\"\n}"
                        },
                        "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/orders"
                      },
                      "response": []
                    },
                    {
                      "_postman_id": "3bbf1d15-fb04-43c4-a9ae-c4b30bf49348",
                      "name": "Order - Get Order",
                      "event": [
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "cf9587e9-5dd3-425a-87a6-ac1f44ed4298",
                            "exec": [
                              "const utils = eval(globals.loadUtils);",
                              "utils.getToken(\"orders\", pm.environment.get(\"clientId\"), pm.environment.get(\"secret\"));"
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "test",
                          "script": {
                            "id": "86fae201-1777-4c49-b2c0-1a2954ea1904",
                            "exec": [
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "utils.checkResponseCode(200);",
                              "",
                              "pm.test(\"Order id in response\", function () {",
                              "    const orderId = json.orderId;",
                              "    pm.expect(orderId).to.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/);",
                              "});",
                              "",
                              "pm.test(\"Billet in response\", function () {",
                              "    const ebillet = json.transactions[0].transactionAttributes.ebillet;",
                              "    pm.expect(ebillet).to.match(/^[0-9]{38}$/);",
                              "});",
                              "",
                              "pm.test(\"Contains Proposal id\", function () {",
                              "    const proposalId = json.proposal.id;",
                              "    pm.expect(proposalId).to.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/);",
                              "});",
                              "",
                              "pm.test(\"Contains Proposal partner\", function () {",
                              "    const proposalPartner = json.proposal.partner;",
                              "    pm.expect(proposalPartner).to.equal(\"BUS_DIRECT\");",
                              "});",
                              "",
                              "pm.test(\"Contains Proposal price\", function () {",
                              "    const proposalPrice = json.proposal.price.amount;",
                              "    pm.expect(proposalPrice).to.equal(600);",
                              "});",
                              "",
                              "pm.test(\"Contains Proposal fares price\", function () {",
                              "    const faresPrice = json.proposal.fares[0].price.amount;",
                              "    pm.expect(faresPrice).to.equal(600);",
                              "});",
                              "",
                              "pm.test(\"Contains BUS DIRECT Segment\", function () {",
                              "    const busDirectName = json.segment.busAttributes.line.name;",
                              "    pm.expect(busDirectName).to.contains(\"BUS DIRECT\");",
                              "});",
                              "",
                              "pm.test(\"Contains Customer id\", function () {",
                              "    const customerId = json.customerId;",
                              "    pm.expect(customerId).to.equal(pm.environment.get(\"customerId\"));",
                              "});",
                              "",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "GET",
                        "header": [
                          {
                            "key": "Content-Type",
                            "value": "application/json"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": ""
                        },
                        "url": {
                          "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/orders/:id",
                          "protocol": "https",
                          "host": [
                            "api",
                            "maas-{{account}}",
                            "aws",
                            "vsct",
                            "fr"
                          ],
                          "path": [
                            "{{envName}}",
                            "orders",
                            ":id"
                          ],
                          "variable": [
                            {
                              "key": "id",
                              "value": "{{orderId}}"
                            }
                          ]
                        }
                      },
                      "response": []
                    }
                  ],
                  "event": [
                    {
                      "listen": "prerequest",
                      "script": {
                        "id": "7cc904ee-6704-4c90-a520-e85fff9ced59",
                        "type": "text/javascript",
                        "exec": [
                          ""
                        ]
                      }
                    },
                    {
                      "listen": "test",
                      "script": {
                        "id": "8c23fd28-ee9c-4d12-8f5f-2349bac2d02c",
                        "type": "text/javascript",
                        "exec": [
                          ""
                        ]
                      }
                    }
                  ],
                  "_postman_isSubFolder": true
                }
              ],
              "_postman_isSubFolder": true
            },
            {
              "_postman_id": "8f5b306b-0feb-4ec3-a8e0-f40aeb04e570",
              "name": "Get Order",
              "description": "",
              "item": [
                {
                  "_postman_id": "e4c5f806-2790-4048-a32e-5d28cf18ba80",
                  "name": "Order not found",
                  "description": "",
                  "item": [
                    {
                      "_postman_id": "67b34b3d-8590-400b-9038-982d631166a0",
                      "name": "Get Order - Order not found",
                      "event": [
                        {
                          "listen": "prerequest",
                          "script": {
                            "id": "cf9587e9-5dd3-425a-87a6-ac1f44ed4298",
                            "exec": [
                              "const utils = eval(globals.loadUtils);",
                              "utils.getToken(\"orders\", pm.environment.get(\"clientId\"), pm.environment.get(\"secret\"));"
                            ],
                            "type": "text/javascript"
                          }
                        },
                        {
                          "listen": "test",
                          "script": {
                            "id": "86fae201-1777-4c49-b2c0-1a2954ea1904",
                            "exec": [
                              "const json = pm.response.json();",
                              "",
                              "const utils = eval(globals.loadUtils);",
                              "utils.checkResponseCode(404);",
                              "",
                              "",
                              "pm.test(\"Contains message 'ORDER_NOT_FOUND'\", function () {",
                              "    const errorCode = json.error.code;",
                              "    pm.expect(errorCode).to.equal(\"ORDER_NOT_FOUND\");",
                              "});",
                              ""
                            ],
                            "type": "text/javascript"
                          }
                        }
                      ],
                      "request": {
                        "method": "GET",
                        "header": [
                          {
                            "key": "Content-Type",
                            "value": "application/json"
                          }
                        ],
                        "body": {
                          "mode": "raw",
                          "raw": ""
                        },
                        "url": {
                          "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/orders/:id",
                          "protocol": "https",
                          "host": [
                            "api",
                            "maas-{{account}}",
                            "aws",
                            "vsct",
                            "fr"
                          ],
                          "path": [
                            "{{envName}}",
                            "orders",
                            ":id"
                          ],
                          "variable": [
                            {
                              "key": "id",
                              "value": "132"
                            }
                          ]
                        }
                      },
                      "response": []
                    }
                  ],
                  "_postman_isSubFolder": true
                }
              ],
              "_postman_isSubFolder": true
            }
          ],
          "_postman_isSubFolder": true
        }
      ]
    },
    {
      "_postman_id": "73a64993-1507-4148-824b-e498a63ac024",
      "name": "Customer care",
      "description": "",
      "item": [
        {
          "_postman_id": "35fcadbb-e759-48ef-96b9-839d0453ad91",
          "name": "Customer care - Post new Customer",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                "exec": [
                  "const utils = eval(globals.loadUtils);",
                  "",
                  "utils.getToken(\"customers\", pm.environment.get(\"clientId\"), pm.environment.get(\"secret\"));",
                  "",
                  "const uniqueId = utils.getUniqueIdBasedOnDate();",
                  "pm.variables.set('uniqueId', uniqueId);",
                  "pm.environment.set('externalId', uniqueId);"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "const utils = eval(globals.loadUtils);",
                  "utils.checkResponseCodeAndStatus(201, \"SUCCESS\");"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n\t\"email\": \"vcasssel{{uniqueId}}@oui.sncf\",\n\t\"firstName\": \"Vincent{{uniqueId}}\",\n\t\"lastName\": \"Cassel{{uniqueId}}\",\n\t\"phoneNumber\": \"0687654321{{uniqueId}}\",\n\t\"externalId\": \"{{externalId}}\"\n}"
            },
            "url": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customers"
          },
          "response": []
        },
        {
          "_postman_id": "0d78af55-a9d0-4753-bd97-a1e8d781a434",
          "name": "Customer care - Search customers",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "75f8a2ed-9f6a-46b4-91bb-d9f36ea7d45f",
                "exec": [
                  "const utils = eval(globals.loadUtils);",
                  "",
                  "utils.getToken(\"customers\", pm.environment.get(\"clientId\"), pm.environment.get(\"secret\"));"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "4adb4a83-5ae7-4307-986e-f9bbfb105a60",
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "const utils = eval(globals.loadUtils);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n\t\"email\": \"fcabrel@oui.sncf{{uniqueId}}\",\n\t\"firstName\": \"Francis{{uniqueId}}\",\n\t\"lastName\": \"CABREL{{uniqueId}}\",\n\t\"phoneNumber\": \"0687654321{{uniqueId}}\",\n\t\"externalId\": \"{{external_id}}\"\n}"
            },
            "url": {
              "raw": "https://api.maas-{{account}}.aws.vsct.fr/{{envName}}/customercare/customers?firstName=Vincent{{externalId}}",
              "protocol": "https",
              "host": [
                "api",
                "maas-{{account}}",
                "aws",
                "vsct",
                "fr"
              ],
              "path": [
                "{{envName}}",
                "customercare",
                "customers"
              ],
              "query": [
                {
                  "key": "firstName",
                  "value": "Vincent{{externalId}}",
                  "equals": true
                }
              ]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": {
      "token": "{{maas_access_token}}"
    }
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "id": "25c3e7a2-d5a8-42b8-bec7-6fc998344251",
        "type": "text/javascript",
        "exec": [
          "postman.setGlobalVariable(\"loadUtils\", function loadUtils() {",
          "    let utils = {};",
          "",
          "",
          "    utils.distance = function distance(lat1, lon1, lat2, lon2, unit) {",
          "",
          "        console.log(lat1 + \",\" + lon1 + \",\" + lat2 + \",\" + lon2 + \",\" + unit);",
          "",
          "\t\tif ((lat1 == lat2) && (lon1 == lon2)) {",
          "\t\t\treturn 0;",
          "\t\t}",
          "\t\telse {",
          "\t\t\tconst radlat1 = Math.PI * lat1/180;",
          "\t\t\tconst radlat2 = Math.PI * lat2/180;",
          "\t\t\tconst theta = lon1-lon2;",
          "\t\t\tconst radtheta = Math.PI * theta/180;",
          "\t\t\tlet dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);",
          "\t\t\tif (dist > 1) {",
          "\t\t\t\tdist = 1;",
          "\t\t\t}",
          "\t\t\tdist = Math.acos(dist);",
          "\t\t\tdist = dist * 180/Math.PI;",
          "\t\t\tdist = dist * 60 * 1.1515;",
          "\t\t\tif (unit==\"K\") { dist = dist * 1.609344 }",
          "\t\t\tif (unit==\"N\") { dist = dist * 0.8684 }",
          "\t\t\treturn dist;",
          "\t\t}",
          "\t}",
          "",
          "",
          "\tutils.getUniqueIdBasedOnDate = function getUniqueIdBasedOnDate() {",
          "",
          "        const date = new Date();",
          "        const year = date.getFullYear().toString().substr(3, 1); // Last number of the year",
          "        const month = date.getMonth() + 1;",
          "        const day = date.getUTCDate();",
          "        const minute = date.getMinutes();",
          "        const hour =date. getHours();",
          "        const second = date.getSeconds();",
          "        const milliseconds = date.getMilliseconds();",
          "        const uniqueId = `${year}${month}${day}${minute}${hour}${second}${milliseconds}`;",
          "        console.log(`Unique ID : ${uniqueId}`);",
          "        return uniqueId;",
          "    }",
          "",
          "",
          "    utils.getToken = function getToken(domain, clientId, secret){",
          "",
          "        console.log(\"getToken(\" + domain + \", \" + clientId + \", \" + secret + \")\");",
          "",
          "    \tconst moment = require('moment');",
          "    \tconst cryptoJs = require('crypto-js');",
          "    \tconst Base64 = cryptoJs.enc.Base64;",
          "    \tconst Utf8 = cryptoJs.enc.Utf8;",
          "",
          "    \tconst account = pm.variables.get('account');",
          "    ",
          "    \tconst parsed = Utf8.parse(`${clientId}:${secret}`);",
          "    \tconst auth = Base64.stringify(parsed);",
          "    ",
          "    \tconst getTokenRequest = {",
          "    \t  url: `https://auth.maas-${account}.aws.vsct.fr/oauth2/token`,",
          "    \t  method: 'POST',",
          "    \t  header: [`Authorization: Basic ${auth}`, 'Content-Type: application/x-www-form-urlencoded'],",
          "    \t  body: {",
          "    \t      mode: 'urlencoded',",
          "    \t      urlencoded: [",
          "    \t          {key: 'grant_type', value: 'client_credentials'},",
          "    \t          {key: 'scope', value: `https://api.maas-${account}.aws.vsct.fr/.*/${domain}.*:.*`}",
          "    \t      ]",
          "    \t  },",
          "    \t};",
          "    ",
          "    \tpm.environment.set('maas_auth_request_date', moment());",
          "    \tpm.sendRequest(getTokenRequest, function (err, res) {",
          "    \t  if (err) {",
          "    \t    console.log(err);",
          "    \t  } else {",
          "    \t    const json = res.json();",
          "    ",
          "    \t    const now = new Date();",
          "    \t    console.log(\"access_token : \" + json.access_token);",
          "    \t    console.log(\"expires_in : \" + json.expires_in);",
          "    \t    pm.environment.set('maas_access_token', json.access_token);",
          "    \t    pm.environment.set('maas_access_token_expire_date', now.getTime() + json.expires_in);",
          "    \t  }",
          "    \t});",
          "    }",
          "",
          "",
          "    utils.sleep = function sleep(millis){",
          "        var date = new Date();",
          "        var curDate = null;",
          "        do { curDate = new Date(); }",
          "        while(curDate-date < millis);",
          "    }",
          "",
          "    // Checks",
          "",
          "    utils.checkJsonSchema = function checkJsonSchema(expectedSchema){",
          "        try{",
          "            pm.expect(json).to.be.jsonSchema(expectedSchema); // returns error if the test fails",
          "            tests['Response has the expected format'] = true;",
          "        } catch (error) {",
          "            tests[error.message + \" => \" + JSON.stringify(pm.response.json())] = false;",
          "        }",
          "    }",
          "",
          "",
          "    utils.checkResponseCode = function checkResponseCode(code){",
          "        pm.test(\"Check Response code = \" + code, function(){",
          "            pm.expect(pm.response.code).to.equal(code);",
          "        }); ",
          "    }",
          "",
          "    utils.checkReponseStatus = function checkResponseStatus(status){",
          "        pm.test(\"Check Json status = \" + status, function(){",
          "            pm.expect(json.status).to.equal(status);",
          "        }); ",
          "    }",
          "",
          "    utils.checkResponseType = function checkResponseType(type){",
          "        pm.test(\"Check Json responseType = \" + type, function(){",
          "            pm.expect(json.responseType).to.equal(type);",
          "        }); ",
          "    }",
          "",
          "    utils.checkResponseCodeAndStatus = function checkResponseCodeAndStatus(code, status){",
          "        pm.test(\"Check Response code = \" + code + \" & Json status = \" + status, function(){",
          "            pm.expect(pm.response.code).to.equal(code);",
          "            pm.expect(json.status).to.equal(status);",
          "        });",
          "    }",
          "",
          "    utils.checkResponseCodeAndType = function checkResponseCodeAndType(code, type){",
          "        pm.test(\"Check Response code = \" + code + \" & Json responseType = \" + type, function(){",
          "            pm.expect(pm.response.code).to.equal(code);",
          "            pm.expect(json.responseType).to.equal(type);",
          "        });",
          "    }",
          "",
          "    utils.checkResponseError = function checkResponseError(error){",
          "        pm.test(\"Check Json error = \" + error, function(){",
          "            pm.expect(json.error).to.equal(error);",
          "        });",
          "    }",
          "",
          "    utils.checkResponseMessage = function checkResponseMessage(message){",
          "        pm.test(\"Check Json message = \" + message, function(){",
          "            pm.expect(json.message).to.equal(message);",
          "        });",
          "    }",
          "",
          "    // Alert when test fails",
          "",
          "    utils.alertWhenResponseCodeNotEqualTo = function alertWhenResponseCodeNotEqualTo(code){",
          "        if(pm.response.code != code){",
          "            utils.checkResponseCode(code);",
          "            //tests['ERROR : expected code => ' + code + ', current code => ' + pm.response.code] = false;",
          "        }",
          "    }",
          "",
          "",
          "    return utils;",
          "",
          "} + '; loadUtils();');",
          "//tests['Utils initialized'] = true;",
          "",
          "/**",
          " * Example use of this library",
          " * ",
          " * const utils = globals.loadUtils;",
          " * const distance = utils.distance(...);",
          " */"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "id": "7217df5c-96d0-44d8-bfed-9b618f21f793",
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    }
  ]
}